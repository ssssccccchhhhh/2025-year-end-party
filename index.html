<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>í¬ë¡œìŠ¤í• ìŠˆí¼ë°¤ - 2025 YEAR-END PARTY</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      --primary: #8B4513;
      --primary-dark: #5D2E0C;
      --primary-light: #A0522D;
      --bg-cream: #FDF5E6;
      --bg-card: #FAF0E1;
      --accent-red: #C41E3A;
      --accent-gold: #DAA520;
      --text-dark: #2C1810;
      --text-muted: #6B5344;
      --success: #228B22;
      --warning: #FF8C00;
      --shadow: 0 4px 20px rgba(139, 69, 19, 0.15);
    }
    
    body {
      font-family: 'Noto Sans KR', sans-serif;
      background: var(--bg-cream);
      background-image: 
        radial-gradient(circle at 20% 50%, rgba(139, 69, 19, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(218, 165, 32, 0.05) 0%, transparent 40%),
        radial-gradient(circle at 40% 80%, rgba(196, 30, 58, 0.03) 0%, transparent 40%);
      min-height: 100vh;
      color: var(--text-dark);
    }
    
    .title-font {
      font-family: 'Black Han Sans', sans-serif;
    }
    
    /* ë‹¨ì–´ ì¤„ë°”ê¿ˆ ë°©ì§€ */
    .no-break {
      word-break: keep-all;
      overflow-wrap: break-word;
    }
    
    body {
      word-break: keep-all;
      overflow-wrap: break-word;
    }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    
    ::-webkit-scrollbar-track {
      background: var(--bg-cream);
    }
    
    ::-webkit-scrollbar-thumb {
      background: var(--primary-light);
      border-radius: 3px;
    }
    
    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    
    .animate-in {
      animation: fadeInUp 0.4s ease-out forwards;
    }
    
    .pulse {
      animation: pulse 0.3s ease-in-out;
    }
    
    .shake {
      animation: shake 0.3s ease-in-out;
    }
    
    /* ëˆˆ ë‚´ë¦¼ íš¨ê³¼ */
    @keyframes snowfall {
      0% {
        transform: translateY(-10vh) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(110vh) rotate(360deg);
        opacity: 0.3;
      }
    }
    
    .snowflake {
      position: fixed;
      top: -20px;
      color: white;
      text-shadow: 0 0 5px rgba(255,255,255,0.8);
      pointer-events: none;
      z-index: 9999;
      animation: snowfall linear infinite;
    }
    
    .snow-container {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 9999;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect, useRef, useCallback } = React;
    
    // ì½”ì¹˜ ë°ì´í„°
    const COACHES = [
      { id: 'JAEKYUNG', name: 'ì¬ê²½', gender: 'male' },
      { id: 'BONGSOO', name: 'ë´‰ìˆ˜', gender: 'male' },
      { id: 'SEYOUNG', name: 'ì„¸ì˜', gender: 'male' },
      { id: 'YEJEE', name: 'ì˜ˆì§€', gender: 'female' }
    ];
    
    // ì™€ë“œ ë£°ë¶
    const RULEBOOK = {
      1: `EVENT 1 (ì´7ë¶„)
AMRAP 3MIN (ì—¬ì3/ë‚¨ì3) 
-15 SYNC. BOX JUMP
-MAX CAL ROW / SKI / BIKE

*3ë¶„ ìš´ë™
-15ì‹±í¬ë¡œ ë²„í”¼ í›„ ë‚¨ì€ì‹œê°„ ë¨¸ì‹ íƒ€ê¸°.
-ì—¬ìì„ ìˆ˜ 3ë¶„ ì§„í–‰ , 1ë¶„ ë¸Œë ˆì´í¬ , ë‚¨ìì„ ìˆ˜ 3ë¶„ ì§„í–‰

*ë²„í”¼
-3ëª… ì „ì›ì˜ ê°€ìŠ´ì´ ë°”ë‹¥ì— ë‹¿ì€ ìƒíƒœì—ì„œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
-ë°•ìŠ¤ì— ì˜¬ë¼ê°€ëŠ” íƒ€ì´ë°, ë‚´ë ¤ì˜¤ëŠ” íƒ€ì´ë°ì€ ì„œë¡œ ë‹¬ë¼ë„ ë¬´ê´€í•©ë‹ˆë‹¤.
-ë°•ìŠ¤ ìŠ¤í…ì—…,ìŠ¤í…ë‹¤ìš´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
-ë°•ìŠ¤ë†’ì´ ì—¬ì20ì¸ì¹˜ / ë‚¨ì 24ì¸ì¹˜. 

*ë¨¸ì‹ 
-1ì¸ë‹¹ 1ê°œì˜ ì •í•´ì§„ ë¨¸ì‹ ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
-3ëª… ì „ì›ì´ ë²„í”¼ê°€ ëë‚˜ë©´ ë‚¨ì€ ì‹œê°„ë™ì•ˆ ë¨¸ì‹ ì„ íƒ‘ë‹ˆë‹¤.
-3ëª… ì „ì›ì˜ ì¹¼ë¡œë¦¬ í•©ì„ ê¸°ë¡í•©ë‹ˆë‹¤.
-ë¨¸ì‹ ì€ ë‹¤ë¥¸ íŒ€ì›ë“¤ì´ ì „ì›ì„ ì¼œë†“ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

*ê¸°ë¡
1) ì—¬ì 3ëª… ì¹¼ë¡œë¦¬ ì´í•©ìœ¼ë¡œ ë†’ì€íŒ€ ìˆœìœ¼ë¡œ 4,3,2,1ì  
2) ë‚¨ì 3ëª… ì¹¼ë¡œë¦¬ ì´í•©ìœ¼ë¡œ ë†’ì€íŒ€ ìˆœìœ¼ë¡œ 4,3,2,1ì `,

      2: `EVENT 2
1)1RM HANG SNATCH IN 4MIN
2)1RM HANG CLEAN IN 4MIN
3)MAX THRUSTER IN 3MIN

-A,B,C,DíŒ€ì˜ ê° ìŠ¤ë‚´ì¹˜ ì„ ìˆ˜ê°€ ë‚˜ì™€ì„œ 4ë¶„ë™ì•ˆ 1RMì„ ì¸¡ì •í•©ë‹ˆë‹¤. (ì—¬)
-A,B,C,DíŒ€ì˜ ê° ìŠ¤ë‚´ì¹˜ ì„ ìˆ˜ê°€ ë‚˜ì™€ì„œ 4ë¶„ë™ì•ˆ 1RMì„ ì¸¡ì •í•©ë‹ˆë‹¤. (ë‚¨)
-A,B,C,DíŒ€ì˜ ê° í´ë¦° ì„ ìˆ˜ê°€ ë‚˜ì™€ì„œ 4ë¶„ë™ì•ˆ 1RMì„ ì¸¡ì •í•©ë‹ˆë‹¤. (ì—¬)
-A,B,C,DíŒ€ì˜ ê° í´ë¦° ì„ ìˆ˜ê°€ ë‚˜ì™€ì„œ 4ë¶„ë™ì•ˆ 1RMì„ ì¸¡ì •í•©ë‹ˆë‹¤. (ë‚¨)
-A,B,C,DíŒ€ì˜ ê° ì“°ëŸ¬ìŠ¤í„° ì„ ìˆ˜ê°€ ë‚˜ì™€ì„œ 3ë¶„ë™ì•ˆ ìµœëŒ€ê°¯ìˆ˜ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤. (ì—¬)
-A,B,C,DíŒ€ì˜ ê° ì“°ëŸ¬ìŠ¤í„° ì„ ìˆ˜ê°€ ë‚˜ì™€ì„œ 3ë¶„ë™ì•ˆ ìµœëŒ€ê°¯ìˆ˜ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤. (ë‚¨)

*í–‰ìŠ¤ë‚´ì¹˜,í–‰í´ë¦°ì€ ìŠ¤ì¿¼íŠ¸/íŒŒì›Œ ëª¨ë‘ ê°€ëŠ¥.
*í–‰ìŠ¤ë‚´ì¹˜/í–‰í´ë¦°/ì“°ëŸ¬ìŠ¤í„° ëª¨ë‘ ë§¤íŠ¸ ìœ„ì—ì„œ ì‹œì‘í•©ë‹ˆë‹¤.
*ë¬´ê²Œ ì¦ëŸ‰ì€ íŒ€ì›ë“¤ì´ ë„ì™€ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
*ì‘ì€ ì›íŒì€ 5íŒŒìš´ë“œ 1ìŒ , 2.5íŒŒìš´ë“œ 1ìŒ, 1íŒŒìš´ë“œ 1ìŒ ì‚¬ìš©ê°€ëŠ¥í•©ë‹ˆë‹¤.

*ê¸°ë¡
-ì—¬ì,ë‚¨ì í´ë¦° ë¬´ê²Œ í•©ìœ¼ë¡œ ë†’ì€ íŒ€ ìˆœìœ¼ë¡œ 4,3,2,1ì 
-ì—¬ì,ë‚¨ì ìŠ¤ë‚´ì¹˜ ë¬´ê²Œ í•©ìœ¼ë¡œ ë†’ì€ íŒ€ ìˆœìœ¼ë¡œ 4,3,2,1ì   
-ì—¬ì,ë‚¨ì ì“°ëŸ¬ìŠ¤í„° ê°¯ìˆ˜ í•©ìœ¼ë¡œ ë†’ì€ íŒ€ ìˆœìœ¼ë¡œ 4,3,2,1ì `,

      3: `EVENT 3
AMRAP 3MIN 
5 ROPE CLIMB +
1) MAX Ring muscle up (ë‚¨)
2) MAX Bar muscle up (ë‚¨)
3) MAX Chest to bar pull up (ë‚¨)
4) MAX Pull up (ì—¬)

*3ë¶„ ì•ˆì— 5ê°œì˜ ë¡œí”„ë¥¼ íƒ€ê³  ë‚¨ì€ ì‹œê°„ë™ì•ˆ ì •í•´ì§„ ë™ì‘ì„ 
ìµœëŒ€í•œ ë§ì´ ìˆ˜í–‰í•˜ê¸°

*ê¸°ë¡
-ê° ë™ì‘ë‹¹ ë†’ì€ìˆœìœ¼ë¡œ 4,3,2,1ì `,

      4: `EVENT 4
-6 Rounds
200m Run + 50M Sled push (ì™•ë³µ2ë²ˆ)

*ë‹¬ë¦¬ëŠ” ë„ì¤‘ì—ëŠ” ì†ì¡ì´ë¥¼ ì¡ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
*ê³„ê¸°íŒ ê±°ë¦¬ê°€ 0.2ë¥¼ ì°ìœ¼ë©´ ë‚´ë ¤ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
*ìŠ¬ë ˆë“œì˜ ë ë¶€ë¶„ì´ ë¼ì¸ì— ê±¸ì¹˜ê¸°ë§Œ í•´ë„ ë©ë‹ˆë‹¤.
*íŒ€ì›ì´ ë‹¤ìŒ ì£¼ìì˜ ìŠ¬ë ˆë“œ ë¬´ê²Œë¥¼ ì¦ëŸ‰í•´ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
*ë‹¤ìŒì£¼ìëŠ” ì•ì„  ì£¼ìì˜ ìŠ¬ë ˆë“œ ê³¨ì¸ ì§€ì ì— ì„œìˆë‹¤ê°€
ìŠ¬ë ˆë“œê°€ ê³¨ì¸í•˜ë©´ íŠ¸ë ˆë“œë°€ë¡œ ì˜¬ë¼ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

*ê¸°ë¡
-6ëª…ì´ ëë‚œ ì‹œê°„ì„ ê¸°ë¡í•˜ê³  ë¹ ë¥¸ ìˆœìœ¼ë¡œ 4,3,2,1ì `,

      5: `EVENT 5
-1330íŒŒìš´ë“œ / 605í‚¤ë¡œ ìŠ¬ë ˆë“œ í’€
-2ë¶„ë™ì•ˆ ìµœëŒ€í•œ ë©€ë¦¬ ëŒê³ ê°‘ë‹ˆë‹¤.
-ìŠ¬ë ˆë“œì— ìˆëŠ” 1ì¹¸ í‘œì‹œë‹¹ 1ë©ì…ë‹ˆë‹¤. 
-2ë¶„ë‚´ì— ëê¹Œì§€ ë„ì°©í•˜ë©´ 
 ë°˜ëŒ€í¸ ë¡œí”„ë¥¼ ì¡ê³  ëŒì•„ê°‘ë‹ˆë‹¤. 

*ê¸°ë¡
-ë©€ë¦¬ ê°„ ìˆœì„œëŒ€ë¡œ 4,3,2,1ì `,

      6: `EVENT 6
1) 1MIN MAX SEATED ROW (ì—¬)
2) 1MIN MAX SEATED ROW (ë‚¨)
3) 1MIN MAX CHEST PRESS (ì—¬)
4) 1MIN MAX CHEST PRESS (ë‚¨)
5) 1MIN MAX LEG PRESS (ì—¬)
6) 1MIN MAX LEG PRESS (ë‚¨)

*ë¨¸ì‹ ì—ì„œ 1ë¶„ ì„¸íŒ… í›„ WORK ê°’ ì¸¡ì •
*ë§¤ 1ë¶„ì´ ëë‚˜ë©´ ë‹¤ì‹œ ë¨¸ì‹  ì„¸íŒ… í›„
ë‹¤ìŒ ì„ ìˆ˜ê°€ ì¶œë°œ.

*ê¸°ë¡
-6ëª…ì˜ ì´ WORKê°’ì„ ê¸°ë¡í•˜ê³ 
ë†’ì€ ìˆœìœ¼ë¡œ 4,3,2,1ì `
    };
    
    // íŒ€ ë°ì´í„°
    const TEAMS_DATA = {
      'D': {
        name: 'TEAM D',
        male: ['ê¹€ë™ì„', 'ê¹€ì„±í˜„', 'ê¹€ì¬ëª…', 'ì„œê²½ë•', 'ì†¡ì°½í˜„', 'ìœ¤ì„í™˜', 'ì´ìš°ê·¼', 'ì„ì¤€ì„­', 'ìµœíš¨ê·¼'],
        female: ['ê¹€ìˆ˜ì •', 'ê¹€ì˜', 'ê¹€í¬ì—°', 'ë°•ì†¡ì´', 'ë°•ìˆ˜ì§„', 'ì‹ í•´ì†”'],
        allowedCoaches: ['JAEKYUNG', 'BONGSOO', 'SEYOUNG', 'YEJEE']
      },
      'C': {
        name: 'TEAM C',
        male: ['ê¹€ìœ¤ì² ', 'ë°•ì˜ì¤€', 'ë°•ì¥ìš°', 'ì–‘ì§€ë°±', 'ìœ¤í˜•í›ˆ', 'ì´ì¬ì™•', 'ì´ì¢…íœ˜', 'ì „ì¬ì›', 'í•œì˜ˆì„­'],
        female: ['ê³ ìˆ˜í˜„', 'ë°°í˜„ì§€', 'ì™•ì†¡í¬', 'ì •ì£¼ì—°', 'ìµœë‚˜ì€', 'í•˜ë¼ì—°'],
        allowedCoaches: ['JAEKYUNG', 'BONGSOO', 'SEYOUNG', 'YEJEE']
      },
      'B': {
        name: 'TEAM B',
        male: ['ê¹€ê·œë‚¨', 'ë…¸ì˜ìˆ˜', 'ë°°í™ë¯¼', 'ì‹ í˜„ì¬', 'ì‹¬ìˆ˜ì˜', 'ì–‘íƒœì¼', 'ì´ì„í¬', 'ì´í˜¸ì˜', 'í•˜ì§„ê´€'],
        female: ['ê¹€ì§€ìœ¤', 'ê¹€ì§„ì•„', 'ì„í•˜ê²½', 'ì£¼ì†Œë‚˜', 'ì¢Œë¯¸ì£¼', 'í—ˆìœ ì§„'],
        allowedCoaches: ['JAEKYUNG', 'BONGSOO', 'SEYOUNG', 'YEJEE']
      },
      'A': {
        name: 'TEAM A',
        male: ['ê°•ë³‘ê´€', 'ê¹€ì •ì¸', 'ë°•ë³‘í›ˆ', 'ì‹¬ì¬ì˜', 'ì¡°ê¸°ì—´', 'ìµœì°½ìš±', 'ìµœí˜„ë•', 'í•œìŠ¹ì¢…'],
        female: ['ê¹€ë¯¼ì§€', 'ë°•í˜„ì£¼', 'ë°°ì§„ì˜', 'ì†¡ê²½í•˜', 'ì´ì„ ë¯¼', 'ì´ì±„ì§„', 'ì¡°ì€ë³„'],
        allowedCoaches: ['JAEKYUNG', 'BONGSOO', 'SEYOUNG'] // ì˜ˆì§€ ì½”ì¹˜ ì œì™¸
      }
    };
    
    // ì´ë²¤íŠ¸ ë°ì´í„° - ì—¬ì„± ì¸ì›ìˆ˜ì— ë”°ë¼ ë™ì  ìƒì„±
    const getEventsData = (femaleCount) => {
      const isFemale7 = femaleCount >= 7;
      
      return [
        {
          id: 1,
          name: 'MAD MAX',
          description: 'AMRAP 3ë¶„ Ã— 2ì„¸íŠ¸ | 15 Sync Burpee Box Jump â†’ Max Cal Row/Bike/Ski',
          detail: 'ì—¬ìíŒ€(F1/F2/F3) 3ë¶„ â†’ 1ë¶„ Break â†’ ë‚¨ìíŒ€(M1/M2/M3) 3ë¶„',
          slots: [
            { id: 'F1', label: 'F1', action: 'Sync BBJ + Row', gender: 'female' },
            { id: 'F2', label: 'F2', action: 'Sync BBJ + Bike', gender: 'female' },
            { id: 'F3', label: 'F3', action: 'Sync BBJ + Ski', gender: 'female' },
            { id: 'M1', label: 'M1', action: 'Sync BBJ + Row', gender: 'male' },
            { id: 'M2', label: 'M2', action: 'Sync BBJ + Bike', gender: 'male' },
            { id: 'M3', label: 'M3', action: 'Sync BBJ + Ski', gender: 'male' }
          ]
        },
        {
          id: 2,
          name: 'TRIPLE LIFT',
          description: '1RM Hang Clean (4ë¶„) â†’ 1RM Hang Snatch (4ë¶„) â†’ Max Thruster 135/85 (3ë¶„)',
          detail: 'F1/M1: Hang Clean | F2/M2: Hang Snatch | F3/M3: Thruster',
          slots: [
            { id: 'F1', label: 'F1', action: '1RM Hang Clean', gender: 'female' },
            { id: 'M1', label: 'M1', action: '1RM Hang Clean', gender: 'male' },
            { id: 'F2', label: 'F2', action: '1RM Hang Snatch', gender: 'female' },
            { id: 'M2', label: 'M2', action: '1RM Hang Snatch', gender: 'male' },
            { id: 'F3', label: 'F3', action: 'Max Thruster (85lb)', gender: 'female' },
            { id: 'M3', label: 'M3', action: 'Max Thruster (135lb)', gender: 'male' }
          ]
        },
        {
          id: 3,
          name: 'SKYSCRAPER',
          description: isFemale7
            ? 'AMRAP 3ë¶„ Ã— 4ì„¸íŠ¸ | 5 Rope Climb â†’ Max MU / Pull Up'
            : 'AMRAP 3ë¶„ Ã— 4ì„¸íŠ¸ | 5 Rope Climb â†’ Max Ring MU / Bar MU / C2B PU / PU',
          note: isFemale7 
            ? 'ì—¬ì„± 7ì¸íŒ€: (3)(4) ëª¨ë‘ ì—¬ì„± Pull Up' 
            : 'ì—¬ì„± 6ì¸íŒ€: (3) ë‚¨ì„± C2B Pull Up, (4) ì—¬ì„± Pull Up',
          slots: isFemale7 
            ? [
                { id: 'M1', label: 'M1', action: '5 Rope Climb + Max Ring MU', gender: 'male' },
                { id: 'M2', label: 'M2', action: '5 Rope Climb + Max Bar MU', gender: 'male' },
                { id: 'F1', label: 'F1', action: '5 Rope Climb + Max Pull Up', gender: 'female' },
                { id: 'F2', label: 'F2', action: '5 Rope Climb + Max Pull Up', gender: 'female' }
              ]
            : [
                { id: 'M1', label: 'M1', action: '5 Rope Climb + Max Ring MU', gender: 'male' },
                { id: 'M2', label: 'M2', action: '5 Rope Climb + Max Bar MU', gender: 'male' },
                { id: 'M3', label: 'M3', action: '5 Rope Climb + Max C2B PU', gender: 'male' },
                { id: 'F1', label: 'F1', action: '5 Rope Climb + Max Pull Up', gender: 'female' }
              ]
        },
        {
          id: 4,
          name: 'SUPER TRAIN',
          description: '6 Rounds Relay For Time | 200m Run + 50m Sled Push',
          note: isFemale7 
            ? 'ì—¬ì„± 7ì¸íŒ€: 3R ì—¬ì„± ì¶œì „ (90lbs)' 
            : 'ì—¬ì„± 6ì¸íŒ€: 3R ë‚¨ì„± ì¶œì „ (135lbs)',
          slots: isFemale7
            ? [
                { id: '1R', label: 'F1', action: '200m Run + Sled Push 45lb', gender: 'female' },
                { id: '2R', label: 'F2', action: '200m Run + Sled Push 90lb', gender: 'female' },
                { id: '3R', label: 'F3', action: '200m Run + Sled Push 90lb', gender: 'female' },
                { id: '4R', label: 'M1', action: '200m Run + Sled Push 170lb', gender: 'male' },
                { id: '5R', label: 'M2', action: '200m Run + Sled Push 215lb', gender: 'male' },
                { id: '6R', label: 'M3', action: '200m Run + Sled Push 250lb', gender: 'male' }
              ]
            : [
                { id: '1R', label: 'F1', action: '200m Run + Sled Push 45lb', gender: 'female' },
                { id: '2R', label: 'F2', action: '200m Run + Sled Push 90lb', gender: 'female' },
                { id: '3R', label: 'M1', action: '200m Run + Sled Push 135lb', gender: 'male' },
                { id: '4R', label: 'M2', action: '200m Run + Sled Push 170lb', gender: 'male' },
                { id: '5R', label: 'M3', action: '200m Run + Sled Push 215lb', gender: 'male' },
                { id: '6R', label: 'M4', action: '200m Run + Sled Push 250lb', gender: 'male' }
              ]
        },
        {
          id: 5,
          name: 'TUG OF SLED',
          description: 'ìŠ¬ë ˆë“œ ë‹¹ê¸°ê¸° | ë‚¨ì 3ëª… vs ìƒëŒ€íŒ€ ë‚¨ì 3ëª…',
          detail: 'Timecap: 30ì´ˆ',
          slots: [
            { id: 'M1', label: 'M1', action: 'Tug of Sled', gender: 'male' },
            { id: 'M2', label: 'M2', action: 'Tug of Sled', gender: 'male' },
            { id: 'M3', label: 'M3', action: 'Tug of Sled', gender: 'male' }
          ]
        },
        {
          id: 6,
          name: 'ROAD TO STRENGTH',
          description: '1ë¶„ Max Work Ã— 6ì„¸íŠ¸ | Leg Press â†’ Chest Press â†’ Seated Row',
          detail: 'F/M ê°ê° 3ê°€ì§€ ë¨¸ì‹  ìˆœì„œëŒ€ë¡œ ì§„í–‰',
          slots: [
            { id: 'F1', label: 'F1', action: '1min Max Leg Press', gender: 'female' },
            { id: 'M1', label: 'M1', action: '1min Max Leg Press', gender: 'male' },
            { id: 'F2', label: 'F2', action: '1min Max Chest Press', gender: 'female' },
            { id: 'M2', label: 'M2', action: '1min Max Chest Press', gender: 'male' },
            { id: 'F3', label: 'F3', action: '1min Max Seated Row', gender: 'female' },
            { id: 'M3', label: 'M3', action: '1min Max Seated Row', gender: 'male' }
          ]
        }
      ];
    };
    
    // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ í‚¤
    const STORAGE_KEY = 'crossfit-superbam-assignments';
    const COACH_STORAGE_KEY = 'crossfit-superbam-coaches';
    
    // ì»´í¬ë„ŒíŠ¸: í—¤ë”
    const Header = ({ selectedTeam, onTeamChange, teamCoaches, onCoachChange }) => {
      const team = TEAMS_DATA[selectedTeam];
      const selectedCoach = teamCoaches[selectedTeam];
      const coachInfo = selectedCoach ? COACHES.find(c => c.id === selectedCoach) : null;
      const teamDisplayName = coachInfo ? `TEAM ${selectedCoach}` : team.name;
      
      return (
        <header style={{
          background: 'linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)',
          padding: '20px 16px',
          color: 'white',
          textAlign: 'center',
          position: 'sticky',
          top: 0,
          zIndex: 100,
          boxShadow: '0 4px 20px rgba(0,0,0,0.2)'
        }}>
          <div style={{ maxWidth: '600px', margin: '0 auto' }}>
            <h1 className="title-font" style={{ 
              fontSize: '1.8rem', 
              marginBottom: '4px',
              textShadow: '2px 2px 4px rgba(0,0,0,0.3)'
            }}>
              ğŸ’£ CrossFit Superbomb
            </h1>
            <p style={{ fontSize: '0.9rem', opacity: 0.95, marginBottom: '4px', fontWeight: '600' }}>
              2025 YEAR-END PARTY
            </p>
            <p style={{ fontSize: '0.8rem', opacity: 0.85, marginBottom: '12px' }}>
              ğŸ“… 12/6 (SAT) 13:00
            </p>
            
            <div style={{ display: 'flex', gap: '8px', justifyContent: 'center', flexWrap: 'wrap' }}>
              {Object.keys(TEAMS_DATA).map(teamKey => {
                const coach = teamCoaches[teamKey];
                const displayName = coach ? `TEAM ${coach}` : `TEAM ${teamKey}`;
                
                return (
                  <button
                    key={teamKey}
                    onClick={() => onTeamChange(teamKey)}
                    style={{
                      padding: '8px 16px',
                      border: 'none',
                      borderRadius: '20px',
                      fontWeight: '700',
                      fontSize: '0.8rem',
                      cursor: 'pointer',
                      transition: 'all 0.2s ease',
                      background: selectedTeam === teamKey 
                        ? 'white' 
                        : 'rgba(255,255,255,0.2)',
                      color: selectedTeam === teamKey 
                        ? 'var(--primary-dark)' 
                        : 'white',
                      transform: selectedTeam === teamKey ? 'scale(1.05)' : 'scale(1)'
                    }}
                  >
                    {displayName}
                  </button>
                );
              })}
            </div>
          </div>
        </header>
      );
    };
    
    // ì»´í¬ë„ŒíŠ¸: ì½”ì¹˜ ì„ íƒ ë° ì™€ë“œ ë°°ì •
    const CoachSection = ({ teamKey, teamCoaches, onCoachChange, coachWod, onCoachWodChange, eventsData, assignments }) => {
      const team = TEAMS_DATA[teamKey];
      const selectedCoach = teamCoaches[teamKey];
      const coachInfo = selectedCoach ? COACHES.find(c => c.id === selectedCoach) : null;
      
      // ì´ë¯¸ ë‹¤ë¥¸ íŒ€ì— ë°°ì •ëœ ì½”ì¹˜ í™•ì¸
      const assignedCoaches = Object.entries(teamCoaches)
        .filter(([key, value]) => key !== teamKey && value)
        .map(([key, value]) => value);
      
      const availableCoaches = COACHES.filter(c => 
        team.allowedCoaches.includes(c.id) && !assignedCoaches.includes(c.id)
      );
      
      // ì½”ì¹˜ ì™€ë“œ ë°°ì • ì¹´ìš´íŠ¸
      const coachWodCount = coachWod[teamKey] ? 1 : 0;
      
      return (
        <div style={{
          background: 'var(--bg-card)',
          borderRadius: '16px',
          padding: '16px',
          margin: '16px 16px 0',
          boxShadow: 'var(--shadow)'
        }}>
          <h3 style={{ 
            fontSize: '1rem', 
            marginBottom: '12px',
            color: 'var(--primary-dark)',
            display: 'flex',
            alignItems: 'center',
            gap: '8px'
          }}>
            ğŸ¯ ì½”ì¹˜ ë°°ì •
          </h3>
          
          <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
            {/* ì½”ì¹˜ ì„ íƒ */}
            <div style={{
              display: 'flex',
              alignItems: 'center',
              gap: '10px',
              flexWrap: 'wrap'
            }}>
              <span style={{ fontSize: '0.85rem', fontWeight: '600', minWidth: '60px' }}>
                ì½”ì¹˜:
              </span>
              <select
                value={selectedCoach || ''}
                onChange={(e) => onCoachChange(teamKey, e.target.value || null)}
                style={{
                  flex: 1,
                  minWidth: '120px',
                  padding: '10px 12px',
                  border: '2px solid #e0d5c7',
                  borderRadius: '10px',
                  fontSize: '0.9rem',
                  background: selectedCoach ? '#f0fff0' : 'white',
                  cursor: 'pointer',
                  fontFamily: 'inherit',
                  fontWeight: selectedCoach ? '600' : '400'
                }}
              >
                <option value="">ì½”ì¹˜ ì„ íƒ (ì œë¹„ë½‘ê¸°)</option>
                {availableCoaches.map(coach => (
                  <option key={coach.id} value={coach.id}>
                    {coach.name} ì½”ì¹˜ ({coach.gender === 'male' ? 'ë‚¨' : 'ì—¬'})
                  </option>
                ))}
              </select>
              
              {selectedCoach && (
                <span style={{
                  padding: '6px 12px',
                  borderRadius: '20px',
                  fontSize: '0.8rem',
                  fontWeight: '600',
                  background: coachWodCount === 1 ? 'rgba(34, 139, 34, 0.15)' : 'rgba(255, 140, 0, 0.15)',
                  color: coachWodCount === 1 ? 'var(--success)' : 'var(--warning)',
                  border: `1px solid ${coachWodCount === 1 ? 'var(--success)' : 'var(--warning)'}`
                }}>
                  ì™€ë“œ {coachWodCount}/1 {coachWodCount === 1 && 'âœ“'}
                </span>
              )}
            </div>
            
            {/* ì½”ì¹˜ ì™€ë“œ ì„ íƒ */}
            {selectedCoach && (
              <div style={{
                display: 'flex',
                alignItems: 'center',
                gap: '10px',
                flexWrap: 'wrap'
              }}>
                <span style={{ fontSize: '0.85rem', fontWeight: '600', minWidth: '60px' }}>
                  ì™€ë“œ:
                </span>
                <select
                  value={coachWod[teamKey] || ''}
                  onChange={(e) => onCoachWodChange(teamKey, e.target.value ? parseInt(e.target.value) : null)}
                  style={{
                    flex: 1,
                    minWidth: '120px',
                    padding: '10px 12px',
                    border: '2px solid #e0d5c7',
                    borderRadius: '10px',
                    fontSize: '0.9rem',
                    background: coachWod[teamKey] ? '#f0fff0' : 'white',
                    cursor: 'pointer',
                    fontFamily: 'inherit',
                    fontWeight: coachWod[teamKey] ? '600' : '400'
                  }}
                >
                  <option value="">ì™€ë“œ ì„ íƒ (ì œë¹„ë½‘ê¸°)</option>
                  {eventsData.map(event => (
                    <option key={event.id} value={event.id}>
                      Event {event.id} - {event.name}
                    </option>
                  ))}
                </select>
              </div>
            )}
            
            {teamKey === 'A' && (
              <div style={{
                fontSize: '0.75rem',
                color: 'var(--accent-red)',
                background: 'rgba(196, 30, 58, 0.08)',
                padding: '8px 12px',
                borderRadius: '8px',
                display: 'flex',
                alignItems: 'center',
                gap: '6px'
              }}>
                âš ï¸ ë‚¨ë…€ë¹„ìœ¨ì„ ìœ„í•´ ì˜ˆì§€ ì½”ì¹˜ëŠ” TEAM Aì— ë°°ì • ë¶ˆê°€
              </div>
            )}
          </div>
        </div>
      );
    };
    
    // ì»´í¬ë„ŒíŠ¸: ë©¤ë²„ ì¹´ìš´íŠ¸ í‘œì‹œ
    const MemberStatus = ({ members, assignments, teamKey, eventsData, teamCoaches, coachWod }) => {
      const selectedCoach = teamCoaches[teamKey];
      const coachInfo = selectedCoach ? COACHES.find(c => c.id === selectedCoach) : null;
      const coachWodEvent = coachWod[teamKey];
      
      const getAssignmentCount = (name) => {
        let count = 0;
        Object.values(assignments).forEach(eventAssignments => {
          Object.values(eventAssignments).forEach(assignedName => {
            if (assignedName === name) count++;
          });
        });
        return count;
      };
      
      const allMembers = [...members.male, ...members.female];
      const completed = allMembers.filter(m => getAssignmentCount(m) === 2).length;
      const incomplete = allMembers.filter(m => getAssignmentCount(m) < 2).length;
      const over = allMembers.filter(m => getAssignmentCount(m) > 2).length;
      
      // ì½”ì¹˜ ë°°ì • ìƒíƒœ
      const coachCompleted = coachInfo && coachWodEvent ? 1 : 0;
      const coachIncomplete = coachInfo && !coachWodEvent ? 1 : 0;
      
      // ì „ì²´ í•©ì‚°
      const totalCompleted = completed + coachCompleted;
      const totalIncomplete = incomplete + coachIncomplete;
      
      return (
        <div style={{
          background: 'var(--bg-card)',
          borderRadius: '16px',
          padding: '16px',
          margin: '16px',
          boxShadow: 'var(--shadow)'
        }}>
          <h3 style={{ 
            fontSize: '1rem', 
            marginBottom: '12px',
            color: 'var(--primary-dark)',
            display: 'flex',
            alignItems: 'center',
            gap: '8px'
          }}>
            ğŸ“Š ë°°ì • í˜„í™©
            {coachInfo && (
              <span style={{ fontSize: '0.75rem', color: 'var(--text-muted)', fontWeight: '400' }}>
                (ë©¤ë²„ {allMembers.length}ëª… + ì½”ì¹˜ 1ëª…)
              </span>
            )}
          </h3>
          
          <div style={{ 
            display: 'grid', 
            gridTemplateColumns: 'repeat(3, 1fr)', 
            gap: '8px',
            textAlign: 'center'
          }}>
            <div style={{
              background: 'rgba(34, 139, 34, 0.1)',
              padding: '12px 8px',
              borderRadius: '12px',
              border: '2px solid var(--success)'
            }}>
              <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--success)' }}>
                {totalCompleted}
              </div>
              <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>ì™„ë£Œ âœ“</div>
            </div>
            
            <div style={{
              background: 'rgba(255, 140, 0, 0.1)',
              padding: '12px 8px',
              borderRadius: '12px',
              border: '2px solid var(--warning)'
            }}>
              <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--warning)' }}>
                {totalIncomplete}
              </div>
              <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>ë¯¸ì™„ë£Œ</div>
            </div>
            
            <div style={{
              background: over > 0 ? 'rgba(196, 30, 58, 0.1)' : 'rgba(200,200,200,0.1)',
              padding: '12px 8px',
              borderRadius: '12px',
              border: `2px solid ${over > 0 ? 'var(--accent-red)' : '#ccc'}`
            }}>
              <div style={{ 
                fontSize: '1.5rem', 
                fontWeight: '700', 
                color: over > 0 ? 'var(--accent-red)' : '#999'
              }}>
                {over}
              </div>
              <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>ì´ˆê³¼ âš </div>
            </div>
          </div>
        </div>
      );
    };
    
    // ì»´í¬ë„ŒíŠ¸: ë©¤ë²„ ë¦¬ìŠ¤íŠ¸
    const MemberList = ({ members, assignments, expanded, onToggle, eventsData, teamCoaches, teamKey, coachWod }) => {
      const selectedCoach = teamCoaches[teamKey];
      const coachInfo = selectedCoach ? COACHES.find(c => c.id === selectedCoach) : null;
      const coachWodEvent = coachWod[teamKey];
      
      const getAssignmentCount = (name) => {
        let count = 0;
        Object.values(assignments).forEach(eventAssignments => {
          Object.values(eventAssignments).forEach(assignedName => {
            if (assignedName === name) count++;
          });
        });
        return count;
      };
      
      const getAssignedEvents = (name) => {
        const events = [];
        Object.entries(assignments).forEach(([eventId, eventAssignments]) => {
          Object.entries(eventAssignments).forEach(([slotId, assignedName]) => {
            if (assignedName === name) {
              events.push(`E${eventId}`);
            }
          });
        });
        return events;
      };
      
      const renderMember = (name, gender, isCoach = false) => {
        const count = isCoach ? (coachWodEvent ? 1 : 0) : getAssignmentCount(name);
        const requiredCount = isCoach ? 1 : 2;
        const assignedEvents = isCoach ? (coachWodEvent ? [`E${coachWodEvent}`] : []) : getAssignedEvents(name);
        const status = count === requiredCount ? 'complete' : count > requiredCount ? 'over' : 'incomplete';
        
        return (
          <div 
            key={name}
            style={{
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'space-between',
              padding: '10px 12px',
              background: status === 'complete' 
                ? 'rgba(34, 139, 34, 0.08)' 
                : status === 'over'
                  ? 'rgba(196, 30, 58, 0.08)'
                  : 'white',
              borderRadius: '10px',
              marginBottom: '6px',
              border: `1px solid ${
                status === 'complete' 
                  ? 'var(--success)' 
                  : status === 'over'
                    ? 'var(--accent-red)'
                    : '#e0d5c7'
              }`
            }}
          >
            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
              <span style={{ 
                fontSize: '0.7rem',
                padding: '2px 6px',
                borderRadius: '4px',
                background: isCoach 
                  ? '#FFF3E0' 
                  : gender === 'male' ? '#E3F2FD' : '#FCE4EC',
                color: isCoach 
                  ? '#E65100'
                  : gender === 'male' ? '#1565C0' : '#C2185B'
              }}>
                {isCoach ? 'ì½”ì¹˜' : gender === 'male' ? 'ë‚¨' : 'ì—¬'}
              </span>
              <span style={{ fontWeight: '500', fontSize: '0.95rem' }}>{name}</span>
            </div>
            
            <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
              {assignedEvents.length > 0 && (
                <span style={{ 
                  fontSize: '0.7rem', 
                  color: 'var(--text-muted)',
                  background: 'rgba(139, 69, 19, 0.1)',
                  padding: '2px 6px',
                  borderRadius: '4px'
                }}>
                  {assignedEvents.join(', ')}
                </span>
              )}
              <span style={{
                fontWeight: '700',
                fontSize: '0.85rem',
                color: status === 'complete' 
                  ? 'var(--success)' 
                  : status === 'over'
                    ? 'var(--accent-red)'
                    : 'var(--warning)'
              }}>
                {count}/{requiredCount} {status === 'complete' && 'âœ“'}
              </span>
            </div>
          </div>
        );
      };
      
      const totalMembers = members.male.length + members.female.length + (coachInfo ? 1 : 0);
      
      return (
        <div style={{
          background: 'var(--bg-card)',
          borderRadius: '16px',
          margin: '0 16px 16px',
          boxShadow: 'var(--shadow)',
          overflow: 'hidden'
        }}>
          <button
            onClick={onToggle}
            style={{
              width: '100%',
              padding: '16px',
              background: 'none',
              border: 'none',
              cursor: 'pointer',
              display: 'flex',
              justifyContent: 'space-between',
              alignItems: 'center',
              borderBottom: expanded ? '1px solid #e0d5c7' : 'none'
            }}
          >
            <h3 style={{ 
              fontSize: '1rem',
              color: 'var(--primary-dark)',
              display: 'flex',
              alignItems: 'center',
              gap: '8px'
            }}>
              ğŸ‘¥ íŒ€ì› ëª©ë¡ ({totalMembers}ëª…{coachInfo ? ' Â· ì½”ì¹˜ í¬í•¨' : ''})
            </h3>
            <span style={{ 
              transform: expanded ? 'rotate(180deg)' : 'rotate(0deg)',
              transition: 'transform 0.2s ease',
              fontSize: '1.2rem'
            }}>
              â–¼
            </span>
          </button>
          
          {expanded && (
            <div style={{ padding: '12px 16px' }}>
              {/* ì½”ì¹˜ */}
              {coachInfo && (
                <div style={{ marginBottom: '12px' }}>
                  <div style={{ 
                    fontSize: '0.8rem', 
                    fontWeight: '600',
                    color: '#E65100',
                    marginBottom: '8px',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '4px'
                  }}>
                    ğŸ‘‘ ì½”ì¹˜ (1ëª…) - ì™€ë“œ 1ê°œ í•„ìˆ˜
                  </div>
                  {renderMember(`${coachInfo.name} ì½”ì¹˜`, coachInfo.gender, true)}
                </div>
              )}
              
              <div style={{ marginBottom: '12px' }}>
                <div style={{ 
                  fontSize: '0.8rem', 
                  fontWeight: '600',
                  color: '#1565C0',
                  marginBottom: '8px',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '4px'
                }}>
                  ğŸš¹ ë‚¨ì ({members.male.length}ëª…)
                </div>
                {members.male.map(name => renderMember(name, 'male'))}
              </div>
              
              <div>
                <div style={{ 
                  fontSize: '0.8rem', 
                  fontWeight: '600',
                  color: '#C2185B',
                  marginBottom: '8px',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '4px'
                }}>
                  ğŸšº ì—¬ì ({members.female.length}ëª…)
                </div>
                {members.female.map(name => renderMember(name, 'female'))}
              </div>
            </div>
          )}
        </div>
      );
    };
    
    // ì»´í¬ë„ŒíŠ¸: ì´ë²¤íŠ¸ ì¹´ë“œ
    const EventCard = ({ event, members, assignments, onAssign, onResetEvent, animatingSlot, coachWodEvent, coachInfo, teamDisplayName, femaleCount }) => {
      const [showRulebook, setShowRulebook] = useState(false);
      const [showEventCapture, setShowEventCapture] = useState(false);
      const currentEventAssignments = assignments[event.id] || {};
      
      // ì´ ì´ë²¤íŠ¸ì— ë°°ì •ëœ ìŠ¬ë¡¯ ìˆ˜
      const assignedCount = Object.values(currentEventAssignments).filter(Boolean).length;
      
      // ì½”ì¹˜ê°€ ì´ ì™€ë“œì— ë°°ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸
      const isCoachEvent = coachWodEvent === event.id;
      
      // í˜„ì¬ ì´ë²¤íŠ¸ì— ì´ë¯¸ ë°°ì •ëœ ë©¤ë²„ë“¤
      const alreadyAssignedInThisEvent = Object.values(currentEventAssignments).filter(Boolean);
      
      // ì „ì²´ ë°°ì •ì—ì„œ ê° ë©¤ë²„ì˜ ë°°ì • íšŸìˆ˜ ê³„ì‚°
      const getMemberAssignmentCount = (name) => {
        let count = 0;
        Object.values(assignments).forEach(eventAssignments => {
          Object.values(eventAssignments).forEach(assignedName => {
            if (assignedName === name) count++;
          });
        });
        return count;
      };
      
      // ì½”ì¹˜ê°€ ì´ë¯¸ ì–´ëŠ ìŠ¬ë¡¯ì— ë°°ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸
      const coachAssignedSlotId = isCoachEvent && coachInfo ? 
        Object.entries(currentEventAssignments).find(([id, name]) => name && name.includes('ì½”ì¹˜'))?.[0] : null;
      
      const getAvailableMembers = (slot, canSelectCoach = false) => {
        const allAssigned = [];
        Object.values(assignments).forEach(eventAssignments => {
          Object.values(eventAssignments).forEach(name => {
            if (name) allAssigned.push(name);
          });
        });
        
        let candidates = [];
        if (slot.gender === 'male') {
          candidates = members.male;
        } else if (slot.gender === 'female') {
          candidates = members.female;
        } else {
          candidates = [...members.male, ...members.female];
        }
        
        // ì½”ì¹˜ ì„ íƒ ê°€ëŠ¥í•œ ìŠ¬ë¡¯ì¸ ê²½ìš° ì½”ì¹˜ë„ í›„ë³´ì— ì¶”ê°€
        if (canSelectCoach && coachInfo) {
          candidates = [...candidates, coachInfo.name + ' ì½”ì¹˜'];
        }
        
        // í˜„ì¬ ìŠ¬ë¡¯ì— ë°°ì •ëœ ì‚¬ëŒì€ ì œì™¸í•˜ì§€ ì•ŠìŒ (ìê¸° ìì‹ ì€ ì„ íƒ ê°€ëŠ¥)
        const currentSlotValue = currentEventAssignments[slot.id] || '';
        
        return candidates.map(name => {
          const count = allAssigned.filter(n => n === name).length;
          // ê°™ì€ ì´ë²¤íŠ¸ ë‚´ ë‹¤ë¥¸ ìŠ¬ë¡¯ì— ì´ë¯¸ ë°°ì •ëœ ê²½ìš° disabled
          const isAssignedElsewhere = alreadyAssignedInThisEvent.includes(name) && name !== currentSlotValue;
          return { name, count, disabled: isAssignedElsewhere };
        });
      };
      
      // ëª¨ë“  ìŠ¬ë¡¯ í‘œì‹œ
      const visibleSlots = event.slots;
      
      return (
        <>
        <div 
          className="animate-in"
          style={{
            background: 'var(--bg-card)',
            borderRadius: '16px',
            margin: '0 16px 16px',
            boxShadow: 'var(--shadow)',
            overflow: 'hidden',
            animationDelay: `${event.id * 0.05}s`,
            border: isCoachEvent ? '2px solid #E65100' : 'none'
          }}
        >
          {/* ì´ë²¤íŠ¸ í—¤ë” - í´ë¦­ ì‹œ ë£°ë¶ í† ê¸€ */}
          <div 
            onClick={() => setShowRulebook(!showRulebook)}
            style={{
              background: isCoachEvent
                ? 'linear-gradient(135deg, #E65100 0%, #FF8C00 100%)'
                : 'linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%)',
              padding: '16px',
              color: 'white',
              cursor: 'pointer'
            }}
          >
            <div style={{ 
              display: 'flex', 
              alignItems: 'center', 
              gap: '10px',
              marginBottom: '10px'
            }}>
              <span style={{
                background: 'rgba(255,255,255,0.3)',
                padding: '6px 14px',
                borderRadius: '20px',
                fontSize: '0.8rem',
                fontWeight: '700',
                letterSpacing: '0.5px'
              }}>
                EVENT {event.id}
              </span>
              <h3 className="title-font" style={{ fontSize: '1.4rem', letterSpacing: '1px', flex: 1 }}>
                {event.name}
              </h3>
              {isCoachEvent && (
                <span style={{
                  background: 'rgba(255,255,255,0.25)',
                  padding: '4px 10px',
                  borderRadius: '10px',
                  fontSize: '0.7rem'
                }}>
                  ğŸ‘‘ ì½”ì¹˜
                </span>
              )}
              <span style={{
                background: 'rgba(255,255,255,0.2)',
                padding: '4px 8px',
                borderRadius: '6px',
                fontSize: '0.7rem',
                transform: showRulebook ? 'rotate(180deg)' : 'rotate(0deg)',
                transition: 'transform 0.2s ease'
              }}>
                â–¼
              </span>
            </div>
          </div>
          
          {/* ë£°ë¶ ì•„ì½”ë””ì–¸ */}
          {showRulebook && (
            <div style={{
              background: 'rgba(44, 24, 16, 0.95)',
              color: 'white',
              padding: '16px',
              fontSize: '0.8rem',
              whiteSpace: 'pre-wrap',
              lineHeight: '1.6',
              maxHeight: '300px',
              overflowY: 'auto'
            }}>
              {RULEBOOK[event.id]}
            </div>
          )}
          
          {/* ì™€ë“œ ìƒì„¸ ë‚´ìš© */}
          <div style={{
            background: 'linear-gradient(180deg, rgba(139,69,19,0.08) 0%, rgba(139,69,19,0.02) 100%)',
            padding: '14px 16px',
            borderBottom: '1px solid rgba(139,69,19,0.1)'
          }}>
            <div style={{
              display: 'flex',
              alignItems: 'flex-start',
              gap: '10px',
              marginBottom: (event.note || event.detail) ? '10px' : '0'
            }}>
              <span style={{ fontSize: '1.1rem' }}>ğŸ‹ï¸</span>
              <div>
                <div style={{ 
                  fontSize: '0.95rem', 
                  fontWeight: '600',
                  color: 'var(--primary-dark)',
                  lineHeight: '1.5'
                }}>
                  {event.description}
                </div>
                {event.detail && (
                  <div style={{
                    fontSize: '0.8rem',
                    color: 'var(--text-muted)',
                    marginTop: '4px'
                  }}>
                    {event.detail}
                  </div>
                )}
              </div>
            </div>
            
            {event.note && (
              <div style={{
                display: 'flex',
                alignItems: 'flex-start',
                gap: '8px',
                background: 'rgba(218, 165, 32, 0.15)',
                padding: '10px 12px',
                borderRadius: '10px',
                border: '1px solid rgba(218, 165, 32, 0.3)'
              }}>
                <span style={{ fontSize: '0.9rem' }}>ğŸ’¡</span>
                <span style={{ 
                  fontSize: '0.8rem', 
                  color: 'var(--primary-dark)',
                  lineHeight: '1.4'
                }}>
                  {event.note}
                </span>
              </div>
            )}
            
            {/* ì½”ì¹˜ ë°°ì • í‘œì‹œ */}
            {isCoachEvent && coachInfo && (
              <div style={{
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                background: 'rgba(230, 81, 0, 0.15)',
                padding: '10px 12px',
                borderRadius: '10px',
                border: '1px solid rgba(230, 81, 0, 0.3)',
                marginTop: '10px'
              }}>
                <span style={{ fontSize: '0.9rem' }}>ğŸ‘‘</span>
                <span style={{ 
                  fontSize: '0.85rem', 
                  color: '#E65100',
                  fontWeight: '600'
                }}>
                  {coachInfo.name} ì½”ì¹˜ ì°¸ì—¬
                </span>
              </div>
            )}
          </div>
          
          <div style={{ padding: '16px' }}>
            {/* ì´ë²¤íŠ¸ ì•¡ì…˜ ë²„íŠ¼ë“¤ */}
            {assignedCount > 0 && (
              <div style={{ 
                display: 'flex', 
                justifyContent: 'flex-end', 
                gap: '8px',
                marginBottom: '10px' 
              }}>
                <button
                  onClick={() => setShowEventCapture(true)}
                  style={{
                    padding: '6px 12px',
                    border: '1px solid var(--primary)',
                    borderRadius: '8px',
                    background: 'white',
                    color: 'var(--primary)',
                    fontSize: '0.75rem',
                    fontWeight: '600',
                    cursor: 'pointer',
                    fontFamily: 'inherit',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '4px'
                  }}
                >
                  ğŸ“· ì €ì¥
                </button>
                <button
                  onClick={() => onResetEvent(event.id)}
                  style={{
                    padding: '6px 12px',
                    border: '1px solid var(--accent-red)',
                    borderRadius: '8px',
                    background: 'white',
                    color: 'var(--accent-red)',
                    fontSize: '0.75rem',
                    fontWeight: '600',
                    cursor: 'pointer',
                    fontFamily: 'inherit',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '4px'
                  }}
                >
                  ğŸ”„ ì´ˆê¸°í™”
                </button>
              </div>
            )}
            
            <div style={{ 
              display: 'grid', 
              gridTemplateColumns: 'repeat(auto-fill, minmax(160px, 1fr))',
              gap: '10px'
            }}>
              {visibleSlots.map((slot, slotIndex) => {
                // ì½”ì¹˜ê°€ ë°°ì •ëœ ì´ë²¤íŠ¸ì—ì„œ ê°™ì€ ì„±ë³„ ìŠ¬ë¡¯ì¸ì§€ í™•ì¸
                const isSameGenderAsCoach = isCoachEvent && coachInfo && slot.gender === coachInfo.gender;
                
                // ì½”ì¹˜ê°€ ì•„ì§ ë°°ì •ë˜ì§€ ì•Šì•˜ê±°ë‚˜, ì´ ìŠ¬ë¡¯ì— ì½”ì¹˜ê°€ ë°°ì •ëœ ê²½ìš° ì½”ì¹˜ ì„ íƒ ê°€ëŠ¥
                const canSelectCoach = isSameGenderAsCoach && (!coachAssignedSlotId || coachAssignedSlotId === slot.id);
                
                const available = getAvailableMembers(slot, canSelectCoach);
                const currentValue = currentEventAssignments[slot.id] || '';
                const isAnimating = animatingSlot === `${event.id}-${slot.id}`;
                
                // í˜„ì¬ ë°°ì •ëœ ë©¤ë²„ì˜ ì „ì²´ ë°°ì • íšŸìˆ˜ í™•ì¸
                const assignedMemberCount = currentValue ? getMemberAssignmentCount(currentValue) : 0;
                const isOverAssigned = assignedMemberCount > 2;
                
                // ì½”ì¹˜ê°€ ë°°ì •ëœ ìŠ¬ë¡¯ì¸ì§€ í™•ì¸
                const isCoachAssignedSlot = currentValue && currentValue.includes('ì½”ì¹˜');
                
                // ìŠ¬ë¡¯ ë°°ê²½ìƒ‰ ê²°ì •
                let slotBackground = 'white';
                let slotBorder = currentValue ? '2px solid var(--success)' : '2px dashed #d0c4b4';
                
                if (isOverAssigned) {
                  slotBackground = 'rgba(196, 30, 58, 0.15)';
                  slotBorder = '2px solid var(--accent-red)';
                } else if (isCoachAssignedSlot) {
                  slotBackground = 'rgba(230, 81, 0, 0.12)';
                  slotBorder = '2px solid #E65100';
                } else if (isSameGenderAsCoach && !coachAssignedSlotId && !currentValue) {
                  // ì½”ì¹˜ ë¯¸ë°°ì • ìƒíƒœì—ì„œ ê°™ì€ ì„±ë³„ ìŠ¬ë¡¯ë“¤
                  slotBackground = 'rgba(230, 81, 0, 0.06)';
                  slotBorder = '2px dashed #E65100';
                }
                
                return (
                  <div 
                    key={slot.id}
                    className={isAnimating ? 'pulse' : ''}
                    style={{
                      background: slotBackground,
                      borderRadius: '12px',
                      padding: '12px',
                      border: slotBorder
                    }}
                  >
                    {/* ìŠ¬ë¡¯ ë¼ë²¨ (M1, F2 ë“±) */}
                    <div style={{ 
                      display: 'flex',
                      alignItems: 'center',
                      gap: '6px',
                      marginBottom: '4px'
                    }}>
                      <span style={{
                        width: '10px',
                        height: '10px',
                        borderRadius: '50%',
                        background: isCoachAssignedSlot ? '#E65100' :
                          slot.gender === 'male' 
                            ? '#1565C0' 
                            : slot.gender === 'female'
                              ? '#C2185B'
                              : '#9C27B0'
                      }}></span>
                      <span style={{
                        fontSize: '0.95rem',
                        fontWeight: '700',
                        color: isCoachAssignedSlot ? '#E65100' : 'var(--primary-dark)'
                      }}>
                        {slot.label}
                        {isCoachAssignedSlot && ' ğŸ‘‘'}
                      </span>
                      {isSameGenderAsCoach && !coachAssignedSlotId && (
                        <span style={{
                          fontSize: '0.6rem',
                          background: 'rgba(230, 81, 0, 0.2)',
                          color: '#E65100',
                          padding: '2px 6px',
                          borderRadius: '4px'
                        }}>ì½”ì¹˜ê°€ëŠ¥</span>
                      )}
                      {isOverAssigned && (
                        <span style={{
                          fontSize: '0.65rem',
                          background: 'var(--accent-red)',
                          color: 'white',
                          padding: '2px 6px',
                          borderRadius: '4px',
                          marginLeft: 'auto'
                        }}>ì´ˆê³¼!</span>
                      )}
                    </div>
                    
                    {/* ë™ì‘ ì„¤ëª… */}
                    <div style={{
                      fontSize: '0.75rem',
                      color: 'var(--text-muted)',
                      marginBottom: '8px',
                      padding: '6px 8px',
                      background: isCoachAssignedSlot ? 'rgba(230, 81, 0, 0.1)' : 'rgba(139, 69, 19, 0.06)',
                      borderRadius: '6px',
                      lineHeight: '1.3'
                    }}>
                      {slot.action}
                    </div>
                    
                    <select
                      value={currentValue}
                      onChange={(e) => onAssign(event.id, slot.id, e.target.value)}
                      style={{
                        width: '100%',
                        padding: '8px',
                        border: '1px solid #e0d5c7',
                        borderRadius: '8px',
                        fontSize: '0.85rem',
                        background: isOverAssigned ? 'rgba(196, 30, 58, 0.1)' : 
                          isCoachAssignedSlot ? 'rgba(230, 81, 0, 0.1)' :
                          currentValue ? '#f0fff0' : 'white',
                        cursor: 'pointer',
                        fontFamily: 'inherit'
                      }}
                    >
                      <option value="">ì„ íƒ...</option>
                      {available.map(({ name, count, disabled }) => (
                        <option 
                          key={name} 
                          value={name}
                          disabled={disabled}
                          style={{
                            color: disabled ? '#999' : count >= 2 ? '#C41E3A' : 'inherit'
                          }}
                        >
                          {name} {count > 0 && `(${count})`} {disabled && '- ì´ë¯¸ ë°°ì •ë¨'}
                        </option>
                      ))}
                    </select>
                  </div>
                );
              })}
            </div>
          </div>
        </div>
        
        {/* ì´ë²¤íŠ¸ë³„ ìº¡ì²˜ ëª¨ë‹¬ */}
        {showEventCapture && (
          <EventCaptureView
            event={event}
            assignments={currentEventAssignments}
            coachInfo={isCoachEvent ? coachInfo : null}
            teamDisplayName={teamDisplayName}
            femaleCount={femaleCount}
            onClose={() => setShowEventCapture(false)}
          />
        )}
        </>
      );
    };
    
    // ì»´í¬ë„ŒíŠ¸: ì´ë²¤íŠ¸ë³„ ìº¡ì²˜ ë·°
    const EventCaptureView = ({ event, assignments, coachInfo, teamDisplayName, femaleCount, onClose }) => {
      const captureRef = useRef(null);
      const [processing, setProcessing] = useState(false);
      const [scale, setScale] = useState(0.8);
      
      const getImageBlob = async () => {
        const captureEl = captureRef.current;
        const originalTransform = captureEl.style.transform;
        captureEl.style.transform = 'scale(1)';
        
        await new Promise(resolve => setTimeout(resolve, 100));
        
        const canvas = await html2canvas(captureEl, { 
          backgroundColor: '#FDF5E6', 
          scale: 2.5,
          windowWidth: 400,
          width: 400
        });
        
        captureEl.style.transform = originalTransform;
        
        return new Promise(resolve => {
          canvas.toBlob(blob => resolve(blob), 'image/png');
        });
      };
      
      const handleDownload = async (blob) => {
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.download = `${teamDisplayName || 'TEAM'}-EVENT${event.id}-${event.name}.png`;
        link.href = url;
        link.click();
        URL.revokeObjectURL(url);
      };
      
      const handleShareOrDownload = async () => {
        if (!captureRef.current) return;
        setProcessing(true);
        try {
          const blob = await getImageBlob();
          const file = new File([blob], `${teamDisplayName || 'TEAM'}-EVENT${event.id}-${event.name}.png`, { type: 'image/png' });
          
          if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
            await navigator.share({
              title: `${teamDisplayName} - EVENT ${event.id}`,
              text: `${event.name} ë°°ì •í‘œ`,
              files: [file]
            });
          } else {
            await handleDownload(blob);
          }
        } catch (err) {
          if (err.name === 'AbortError') {
            // ì‚¬ìš©ìê°€ ê³µìœ  ì·¨ì†Œ
          } else {
            // ê³µìœ  ì‹¤íŒ¨ì‹œ ë‹¤ìš´ë¡œë“œë¡œ ëŒ€ì²´
            try {
              const blob = await getImageBlob();
              await handleDownload(blob);
            } catch (downloadErr) {
              console.error('ì €ì¥ ì‹¤íŒ¨:', downloadErr);
              alert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
          }
        }
        setProcessing(false);
      };
      
      // ë°°ì •ëœ ìŠ¬ë¡¯ë“¤
      const assignedSlots = event.slots.filter(slot => assignments[slot.id]);
      
      return (
        <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.9)', zIndex: 1000, display: 'flex', flexDirection: 'column' }}>
          {/* ìƒë‹¨ ì»¨íŠ¸ë¡¤ ë°” */}
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px 16px', background: 'rgba(255,255,255,0.1)', flexWrap: 'wrap', gap: '10px', flexShrink: 0 }}>
            <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
              <button onClick={() => setScale(Math.max(0.5, scale - 0.1))} style={{ padding: '6px 14px', border: 'none', borderRadius: '6px', background: 'rgba(255,255,255,0.2)', color: 'white', fontWeight: '700', fontSize: '1rem', cursor: 'pointer' }}>âˆ’</button>
              <span style={{ color: 'white', fontSize: '0.8rem', minWidth: '50px', textAlign: 'center' }}>{Math.round(scale * 100)}%</span>
              <button onClick={() => setScale(Math.min(1.5, scale + 0.1))} style={{ padding: '6px 14px', border: 'none', borderRadius: '6px', background: 'rgba(255,255,255,0.2)', color: 'white', fontWeight: '700', fontSize: '1rem', cursor: 'pointer' }}>+</button>
            </div>
            <button onClick={onClose} style={{ padding: '6px 16px', border: '2px solid white', borderRadius: '8px', background: 'transparent', color: 'white', fontWeight: '600', cursor: 'pointer', fontFamily: 'inherit' }}>âœ• ë‹«ê¸°</button>
          </div>
          
          {/* ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ */}
          <div style={{ flex: 1, overflow: 'auto', padding: '20px', display: 'flex', justifyContent: 'center', alignItems: 'flex-start' }}>
            <div ref={captureRef} style={{ 
              background: 'var(--bg-cream)', 
              padding: '20px', 
              borderRadius: '16px', 
              transform: `scale(${scale})`, 
              transformOrigin: 'top center', 
              width: '400px', 
              minWidth: '400px' 
            }}>
              {/* í—¤ë” */}
              <div style={{ textAlign: 'center', marginBottom: '16px', paddingBottom: '12px', borderBottom: '2px solid var(--primary)' }}>
                <h2 className="title-font" style={{ color: 'var(--primary-dark)', fontSize: '1.3rem', marginBottom: '4px' }}>ğŸ’£ CrossFit Superbomb</h2>
                <p style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>2025 YEAR-END PARTY Â· 12/6 (SAT) 13:00</p>
                <p style={{ color: 'var(--primary)', fontWeight: '600', fontSize: '1rem', marginTop: '8px' }}>{teamDisplayName}</p>
              </div>
              
              {/* ì´ë²¤íŠ¸ ì¹´ë“œ */}
              <div style={{ background: 'white', borderRadius: '12px', overflow: 'hidden', border: coachInfo ? '2px solid #E65100' : '1px solid #e0d5c7' }}>
                <div style={{ 
                  background: coachInfo 
                    ? 'linear-gradient(135deg, #E65100 0%, #FF8C00 100%)' 
                    : 'linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%)', 
                  padding: '12px 16px', 
                  color: 'white' 
                }}>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                    <span style={{ background: 'rgba(255,255,255,0.3)', padding: '4px 10px', borderRadius: '10px', fontSize: '0.7rem', fontWeight: '700' }}>EVENT {event.id}</span>
                    <span className="title-font" style={{ fontSize: '1rem', flex: 1 }}>{event.name}</span>
                    {coachInfo && <span style={{ fontSize: '0.7rem' }}>ğŸ‘‘ ì½”ì¹˜</span>}
                  </div>
                </div>
                
                {/* ë°°ì • ë‚´ìš© */}
                <div style={{ padding: '12px' }}>
                  <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '10px', lineHeight: '1.4' }}>
                    {event.description}
                  </div>
                  
                  {/* ìŠ¬ë¡¯ ê·¸ë¦¬ë“œ */}
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '8px' }}>
                    {assignedSlots.map(slot => {
                      const memberName = assignments[slot.id];
                      const isCoach = memberName && memberName.includes('ì½”ì¹˜');
                      
                      // ë°°ê²½ìƒ‰/í…Œë‘ë¦¬ ê²°ì • (EventCardì™€ ë™ì¼í•œ í†¤)
                      const slotBackground = isCoach ? 'rgba(230, 81, 0, 0.12)' : 'white';
                      const slotBorder = isCoach ? '2px solid #E65100' : '2px solid var(--success)';
                      
                      // ì„±ë³„ í‘œì‹œ ìƒ‰ìƒ
                      const genderColor = isCoach ? '#E65100' :
                        slot.gender === 'male' ? '#1565C0' : '#C2185B';
                      
                      return (
                        <div key={slot.id} style={{ 
                          background: slotBackground, 
                          padding: '10px', 
                          borderRadius: '12px',
                          border: slotBorder
                        }}>
                          {/* ìŠ¬ë¡¯ ë¼ë²¨ */}
                          <div style={{ 
                            display: 'flex',
                            alignItems: 'center',
                            gap: '6px',
                            marginBottom: '4px'
                          }}>
                            <span style={{
                              width: '8px',
                              height: '8px',
                              borderRadius: '50%',
                              background: genderColor
                            }}></span>
                            <span style={{
                              fontSize: '0.8rem',
                              fontWeight: '700',
                              color: isCoach ? '#E65100' : 'var(--primary-dark)'
                            }}>
                              {slot.label}
                              {isCoach && ' ğŸ‘‘'}
                            </span>
                          </div>
                          
                          {/* ë™ì‘ ì„¤ëª… */}
                          <div style={{
                            fontSize: '0.7rem',
                            color: 'var(--text-muted)',
                            marginBottom: '6px',
                            padding: '4px 6px',
                            background: isCoach ? 'rgba(230, 81, 0, 0.1)' : 'rgba(139, 69, 19, 0.06)',
                            borderRadius: '4px',
                            lineHeight: '1.3'
                          }}>
                            {slot.action}
                          </div>
                          
                          {/* ë°°ì •ëœ ë©¤ë²„ */}
                          <div style={{ 
                            fontSize: '0.9rem', 
                            fontWeight: '600', 
                            color: 'var(--text-dark)',
                            padding: '6px 8px',
                            background: isCoach ? 'rgba(230, 81, 0, 0.1)' : '#f0fff0',
                            borderRadius: '6px',
                            textAlign: 'center'
                          }}>
                            {memberName}
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
              
              {/* í‘¸í„° */}
              <div style={{ textAlign: 'center', marginTop: '12px', fontSize: '0.7rem', color: 'var(--text-muted)' }}>
                ğŸ‹ï¸ í¬ë¡œìŠ¤í• ìŠˆí¼ë°¤
              </div>
            </div>
          </div>
          
          {/* í•˜ë‹¨ ë²„íŠ¼ */}
          <div style={{ padding: '12px 16px', background: 'rgba(255,255,255,0.1)', display: 'flex', justifyContent: 'center', flexShrink: 0 }}>
            <button onClick={handleShareOrDownload} disabled={processing} style={{ padding: '14px 40px', border: 'none', borderRadius: '12px', background: 'linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)', color: 'white', fontWeight: '700', fontSize: '1rem', cursor: processing ? 'wait' : 'pointer', fontFamily: 'inherit', boxShadow: '0 4px 15px rgba(139, 69, 19, 0.4)' }}>
              {processing ? 'ì²˜ë¦¬ ì¤‘...' : 'ğŸ“¤ ê³µìœ í•˜ê¸°'}
            </button>
          </div>
        </div>
      );
    };
    
    // ì»´í¬ë„ŒíŠ¸: ëˆˆ ë‚´ë¦¼ íš¨ê³¼
    const SnowEffect = ({ enabled }) => {
      const [snowflakes, setSnowflakes] = useState([]);
      
      useEffect(() => {
        if (!enabled) {
          setSnowflakes([]);
          return;
        }
        
        const createSnowflake = () => {
          const id = Math.random().toString(36).substr(2, 9);
          const snowChars = ['â„', 'â…', 'â†', 'âœ»', 'âœ¼', 'â‰'];
          return {
            id,
            char: snowChars[Math.floor(Math.random() * snowChars.length)],
            left: Math.random() * 100,
            size: Math.random() * 1.2 + 0.6,
            duration: Math.random() * 5 + 5,
            delay: Math.random() * 2
          };
        };
        
        // ì´ˆê¸° ëˆˆì†¡ì´ ìƒì„±
        const initialSnow = Array.from({ length: 30 }, createSnowflake);
        setSnowflakes(initialSnow);
        
        // ì£¼ê¸°ì ìœ¼ë¡œ ìƒˆ ëˆˆì†¡ì´ ì¶”ê°€
        const interval = setInterval(() => {
          setSnowflakes(prev => {
            const filtered = prev.slice(-50); // ìµœëŒ€ 50ê°œ ìœ ì§€
            return [...filtered, createSnowflake()];
          });
        }, 300);
        
        return () => clearInterval(interval);
      }, [enabled]);
      
      if (!enabled) return null;
      
      return (
        <div className="snow-container">
          {snowflakes.map(flake => (
            <span
              key={flake.id}
              className="snowflake"
              style={{
                left: `${flake.left}%`,
                fontSize: `${flake.size}rem`,
                animationDuration: `${flake.duration}s`,
                animationDelay: `${flake.delay}s`
              }}
            >
              {flake.char}
            </span>
          ))}
        </div>
      );
    };
    
    // ì»´í¬ë„ŒíŠ¸: ì•¡ì…˜ ë²„íŠ¼ë“¤
    const ActionButtons = ({ onReset, onCapture, onRulebookCapture, onSnowToggle, snowEnabled, assignments }) => (
      <div style={{
        position: 'fixed',
        bottom: 0,
        left: 0,
        right: 0,
        background: 'white',
        padding: '12px 16px',
        boxShadow: '0 -4px 20px rgba(0,0,0,0.1)',
        display: 'flex',
        gap: '8px',
        justifyContent: 'center',
        zIndex: 100
      }}>
        <button
          onClick={onSnowToggle}
          style={{
            padding: '12px 14px',
            border: snowEnabled ? '2px solid #4FC3F7' : '2px solid #ccc',
            borderRadius: '12px',
            background: snowEnabled ? 'rgba(79, 195, 247, 0.1)' : 'white',
            color: snowEnabled ? '#0288D1' : '#999',
            fontWeight: '600',
            fontSize: '0.85rem',
            cursor: 'pointer',
            fontFamily: 'inherit'
          }}
          title="ëˆˆ ë‚´ë¦¼ íš¨ê³¼"
        >
          â„ï¸
        </button>
        
        <button
          onClick={onReset}
          style={{
            padding: '12px 16px',
            border: '2px solid var(--accent-red)',
            borderRadius: '12px',
            background: 'white',
            color: 'var(--accent-red)',
            fontWeight: '600',
            fontSize: '0.85rem',
            cursor: 'pointer',
            fontFamily: 'inherit'
          }}
        >
          ğŸ”„ ì´ˆê¸°í™”
        </button>
        
        <button
          onClick={onRulebookCapture}
          style={{
            padding: '12px 16px',
            border: '2px solid var(--primary)',
            borderRadius: '12px',
            background: 'white',
            color: 'var(--primary)',
            fontWeight: '600',
            fontSize: '0.85rem',
            cursor: 'pointer',
            fontFamily: 'inherit'
          }}
        >
          ğŸ“– ë£°ë¶
        </button>
        
        <button
          onClick={onCapture}
          style={{
            padding: '12px 24px',
            border: 'none',
            borderRadius: '12px',
            background: 'linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)',
            color: 'white',
            fontWeight: '600',
            fontSize: '0.85rem',
            cursor: 'pointer',
            fontFamily: 'inherit',
            boxShadow: '0 4px 15px rgba(139, 69, 19, 0.3)'
          }}
        >
          ğŸ“‹ ë°°ì •
        </button>
      </div>
    );

    
    // Footer ì»´í¬ë„ŒíŠ¸
    const Footer = () => {
      return (
        <div style={{
          marginTop: '40px',
          padding: '24px 16px',
          background: 'linear-gradient(to top, var(--bg-card), transparent)',
          borderTop: '1px solid rgba(139, 69, 19, 0.1)',
          textAlign: 'center'
        }}>
          {/* ë¡œê³  ë˜ëŠ” íƒ€ì´í‹€ */}
          <div style={{
            fontSize: '1.2rem',
            fontWeight: '700',
            color: 'var(--primary-dark)',
            marginBottom: '12px',
            fontFamily: "'Black Han Sans', sans-serif"
          }}>
            CrossFit Superbomb
          </div>
          
          {/* ì†Œì…œ ë§í¬ */}
          <div style={{
            display: 'flex',
            justifyContent: 'center',
            gap: '16px',
            marginBottom: '16px'
          }}>
            <a 
              href="https://www.instagram.com/crossfitsuperbomb" 
              target="_blank"
              rel="noopener noreferrer"
              style={{
                display: 'flex',
                alignItems: 'center',
                gap: '6px',
                padding: '8px 16px',
                background: 'linear-gradient(135deg, #833AB4, #C13584, #E1306C, #FD1D1D)',
                color: 'white',
                textDecoration: 'none',
                borderRadius: '20px',
                fontSize: '0.9rem',
                fontWeight: '500',
                transition: 'transform 0.2s',
                boxShadow: '0 2px 8px rgba(193, 53, 132, 0.3)'
              }}
              onMouseOver={(e) => e.currentTarget.style.transform = 'translateY(-2px)'}
              onMouseOut={(e) => e.currentTarget.style.transform = 'translateY(0)'}
            >
              <span style={{ fontSize: '1.2rem' }}>ğŸ“·</span>
              Instagram
            </a>
            
            <a 
              href="https://github.com/ssssccccchhhhh/2025-year-end-party" 
              target="_blank"
              rel="noopener noreferrer"
              style={{
                display: 'flex',
                alignItems: 'center',
                gap: '6px',
                padding: '8px 16px',
                background: '#24292e',
                color: 'white',
                textDecoration: 'none',
                borderRadius: '20px',
                fontSize: '0.9rem',
                fontWeight: '500',
                transition: 'transform 0.2s',
                boxShadow: '0 2px 8px rgba(0, 0, 0, 0.2)'
              }}
              onMouseOver={(e) => e.currentTarget.style.transform = 'translateY(-2px)'}
              onMouseOut={(e) => e.currentTarget.style.transform = 'translateY(0)'}
            >
              <span style={{ fontSize: '1.2rem' }}>ğŸ’»</span>
              GitHub
            </a>
          </div>
          
          {/* êµ¬ë¶„ì„  */}
          <div style={{
            width: '60px',
            height: '2px',
            background: 'var(--accent-gold)',
            margin: '16px auto'
          }}></div>
          
          {/* í•˜ë‹¨ í…ìŠ¤íŠ¸ */}
          <div style={{
            fontSize: '0.85rem',
            color: 'var(--text-muted)',
            lineHeight: '1.6'
          }}>
            <div style={{ marginBottom: '4px' }}>
              2025 Year-End Party Event Assignment System
            </div>
            <div style={{ fontSize: '0.8rem', opacity: 0.7 }}>
              ğŸ¤– Built with AI (Claude) â€¢ Made with â¤ï¸
            </div>
          </div>
          
          {/* ì €ì‘ê¶Œ */}
          <div style={{
            marginTop: '12px',
            fontSize: '0.75rem',
            color: 'var(--text-muted)',
            opacity: 0.6
          }}>
            Â© 2025 CrossFit Superbomb. All rights reserved.
          </div>
        </div>
      );
    };
    
    // ì»´í¬ë„ŒíŠ¸: ë£°ë¶ ìº¡ì³ ë·°
    const RulebookCaptureView = ({ onClose, eventsData }) => {
      const captureRef = useRef(null);
      const [processing, setProcessing] = useState(false);
      const [scale, setScale] = useState(0.6);
      const [columns, setColumns] = useState(2);
      
      const getImageBlob = async () => {
        const captureEl = captureRef.current;
        const originalTransform = captureEl.style.transform;
        captureEl.style.transform = 'scale(1)';
        await new Promise(resolve => setTimeout(resolve, 100));
        
        const canvas = await html2canvas(captureEl, { 
          backgroundColor: '#FDF5E6', 
          scale: 2,
          windowHeight: captureEl.scrollHeight,
          height: captureEl.scrollHeight
        });
        
        captureEl.style.transform = originalTransform;
        
        return new Promise(resolve => {
          canvas.toBlob(blob => resolve(blob), 'image/png');
        });
      };
      
      const handleDownload = async (blob) => {
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.download = 'í¬ë¡œìŠ¤í•ìŠˆí¼ë°¤-ì™€ë“œë£°ë¶.png';
        link.href = url;
        link.click();
        URL.revokeObjectURL(url);
      };
      
      const handleShareOrDownload = async () => {
        if (!captureRef.current) return;
        setProcessing(true);
        try {
          const blob = await getImageBlob();
          const file = new File([blob], 'í¬ë¡œìŠ¤í•ìŠˆí¼ë°¤-ì™€ë“œë£°ë¶.png', { type: 'image/png' });
          
          if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
            await navigator.share({
              title: 'í¬ë¡œìŠ¤í• ìŠˆí¼ë°¤ ì™€ë“œ ë£°ë¶',
              text: '2025 YEAR-END PARTY ì™€ë“œ ë£°ë¶',
              files: [file]
            });
          } else {
            await handleDownload(blob);
          }
        } catch (err) {
          if (err.name === 'AbortError') {
            // ì‚¬ìš©ìê°€ ê³µìœ  ì·¨ì†Œ
          } else {
            try {
              const blob = await getImageBlob();
              await handleDownload(blob);
            } catch (downloadErr) {
              console.error('ì €ì¥ ì‹¤íŒ¨:', downloadErr);
              alert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
          }
        }
        setProcessing(false);
      };
      
      const gridColumns = columns === 1 ? '1fr' : columns === 2 ? 'repeat(2, 1fr)' : 'repeat(3, 1fr)';
      const captureWidth = columns === 1 ? '500px' : columns === 2 ? '800px' : '1100px';
      
      return (
        <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.9)', zIndex: 1000, display: 'flex', flexDirection: 'column' }}>
          {/* ìƒë‹¨ ì»¨íŠ¸ë¡¤ ë°” */}
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px 16px', background: 'rgba(255,255,255,0.1)', flexWrap: 'wrap', gap: '10px', flexShrink: 0 }}>
            <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
              <span style={{ color: 'white', fontSize: '0.75rem' }}>ì—´:</span>
              {[1, 2, 3].map(col => (
                <button key={col} onClick={() => setColumns(col)} style={{ padding: '6px 12px', border: 'none', borderRadius: '6px', background: columns === col ? 'white' : 'rgba(255,255,255,0.2)', color: columns === col ? 'var(--primary-dark)' : 'white', fontWeight: '600', fontSize: '0.8rem', cursor: 'pointer' }}>{col}</button>
              ))}
            </div>
            <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
              <button onClick={() => setScale(Math.max(0.3, scale - 0.1))} style={{ padding: '6px 14px', border: 'none', borderRadius: '6px', background: 'rgba(255,255,255,0.2)', color: 'white', fontWeight: '700', fontSize: '1rem', cursor: 'pointer' }}>âˆ’</button>
              <span style={{ color: 'white', fontSize: '0.8rem', minWidth: '50px', textAlign: 'center' }}>{Math.round(scale * 100)}%</span>
              <button onClick={() => setScale(Math.min(1.2, scale + 0.1))} style={{ padding: '6px 14px', border: 'none', borderRadius: '6px', background: 'rgba(255,255,255,0.2)', color: 'white', fontWeight: '700', fontSize: '1rem', cursor: 'pointer' }}>+</button>
            </div>
            <button onClick={onClose} style={{ padding: '6px 16px', border: '2px solid white', borderRadius: '8px', background: 'transparent', color: 'white', fontWeight: '600', cursor: 'pointer', fontFamily: 'inherit' }}>âœ• ë‹«ê¸°</button>
          </div>
          
          {/* ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ */}
          <div style={{ flex: 1, overflow: 'auto', padding: '20px', display: 'flex', justifyContent: 'center', alignItems: 'flex-start' }}>
            <div ref={captureRef} style={{ background: 'var(--bg-cream)', padding: '24px', borderRadius: '16px', transform: 'scale(' + scale + ')', transformOrigin: 'top center', width: captureWidth, minWidth: captureWidth }}>
              {/* í—¤ë” */}
              <div style={{ textAlign: 'center', marginBottom: '24px', paddingBottom: '16px', borderBottom: '3px solid var(--primary)' }}>
                <h2 className="title-font" style={{ color: 'var(--primary-dark)', fontSize: '1.8rem', marginBottom: '8px' }}>ğŸ“– ì™€ë“œ ë£°ë¶</h2>
                <p style={{ color: 'var(--primary)', fontWeight: '600', fontSize: '1rem' }}>ğŸ’£ CrossFit Superbomb Â· 2025 YEAR-END PARTY</p>
                <p style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginTop: '4px' }}>ğŸ“… 12/6 (SAT) 13:00</p>
              </div>
              
              {/* ë£°ë¶ ë‚´ìš© */}
              <div style={{ display: 'grid', gridTemplateColumns: gridColumns, gap: '16px' }}>
                {eventsData.map(event => (
                  <div key={event.id} style={{ background: 'white', borderRadius: '12px', overflow: 'hidden', border: '1px solid #e0d5c7' }}>
                    <div style={{ background: 'linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%)', padding: '12px 16px', color: 'white' }}>
                      <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                        <span style={{ background: 'rgba(255,255,255,0.3)', padding: '4px 10px', borderRadius: '10px', fontSize: '0.75rem', fontWeight: '700' }}>EVENT {event.id}</span>
                        <span className="title-font" style={{ fontSize: '1.1rem' }}>{event.name}</span>
                      </div>
                    </div>
                    <div style={{ padding: '16px' }}>
                      <div style={{ fontSize: '0.8rem', color: 'var(--text-dark)', whiteSpace: 'pre-wrap', lineHeight: '1.7' }}>
                        {RULEBOOK[event.id]}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
          
          {/* í•˜ë‹¨ ê³µìœ  ë²„íŠ¼ */}
          <div style={{ padding: '12px 16px', background: 'rgba(255,255,255,0.1)', display: 'flex', justifyContent: 'center', flexShrink: 0 }}>
            <button onClick={handleShareOrDownload} disabled={processing} style={{ padding: '14px 40px', border: 'none', borderRadius: '12px', background: 'linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)', color: 'white', fontWeight: '700', fontSize: '1rem', cursor: processing ? 'wait' : 'pointer', fontFamily: 'inherit', boxShadow: '0 4px 15px rgba(139, 69, 19, 0.4)' }}>
              {processing ? 'ì²˜ë¦¬ ì¤‘...' : 'ğŸ“¤ ê³µìœ í•˜ê¸°'}
            </button>
          </div>
        </div>
      );
    };
    
    // ì»´í¬ë„ŒíŠ¸: ìº¡ì³ìš© ê²°ê³¼ ë·°
    const CaptureView = ({ teamKey, members, assignments, onClose, eventsData, teamCoaches, coachWod }) => {
      const captureRef = useRef(null);
      const [processing, setProcessing] = useState(false);
      const [scale, setScale] = useState(0.7);
      const [columns, setColumns] = useState(2);
      
      const selectedCoach = teamCoaches[teamKey];
      const coachInfo = selectedCoach ? COACHES.find(c => c.id === selectedCoach) : null;
      const coachWodEvent = coachWod[teamKey];
      const teamDisplayName = coachInfo ? 'TEAM ' + selectedCoach : TEAMS_DATA[teamKey].name;
      
      // ì—¬ì„± ì¸ì›ìˆ˜ ê³„ì‚° (ì˜ˆì§€ ì½”ì¹˜ í¬í•¨)
      const femaleCount = members.female.length + (coachInfo?.gender === 'female' ? 1 : 0);
      
      const getAssignmentCount = (name) => {
        let count = 0;
        Object.values(assignments).forEach(eventAssignments => {
          Object.values(eventAssignments).forEach(assignedName => {
            if (assignedName === name) count++;
          });
        });
        return count;
      };
      
      const getImageBlob = async () => {
        const captureEl = captureRef.current;
        const originalTransform = captureEl.style.transform;
        captureEl.style.transform = 'scale(1)';
        
        await new Promise(resolve => setTimeout(resolve, 100));
        
        const canvas = await html2canvas(captureEl, { 
          backgroundColor: '#FDF5E6', 
          scale: 2,
          useCORS: true,
          logging: false,
          windowHeight: captureEl.scrollHeight,
          height: captureEl.scrollHeight
        });
        
        captureEl.style.transform = originalTransform;
        
        return new Promise(resolve => {
          canvas.toBlob(blob => resolve(blob), 'image/png');
        });
      };
      
      const handleDownload = async (blob) => {
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.download = teamDisplayName.replace(' ', '-') + '-ì™€ë“œë°°ì •.png';
        link.href = url;
        link.click();
        URL.revokeObjectURL(url);
      };
      
      const handleShareOrDownload = async () => {
        if (!captureRef.current) return;
        setProcessing(true);
        try {
          const blob = await getImageBlob();
          const file = new File([blob], teamDisplayName.replace(' ', '-') + '-ì™€ë“œë°°ì •.png', { type: 'image/png' });
          
          if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
            await navigator.share({
              title: teamDisplayName + ' ì™€ë“œ ë°°ì •',
              text: 'í¬ë¡œìŠ¤í• ìŠˆí¼ë°¤ ì™€ë“œ ë°°ì •í‘œ',
              files: [file]
            });
          } else {
            await handleDownload(blob);
          }
        } catch (err) {
          if (err.name === 'AbortError') {
            // ì‚¬ìš©ìê°€ ê³µìœ  ì·¨ì†Œ
          } else {
            try {
              const blob = await getImageBlob();
              await handleDownload(blob);
            } catch (downloadErr) {
              console.error('ì €ì¥ ì‹¤íŒ¨:', downloadErr);
              alert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
          }
        }
        setProcessing(false);
      };
      
      const gridColumns = columns === 1 ? '1fr' : columns === 2 ? 'repeat(2, 1fr)' : 'repeat(3, 1fr)';
      const captureWidth = columns === 1 ? '400px' : columns === 2 ? '650px' : '900px';
      
      return (
        <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.9)', zIndex: 1000, display: 'flex', flexDirection: 'column' }}>
          {/* ìƒë‹¨ ì»¨íŠ¸ë¡¤ ë°” */}
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px 16px', background: 'rgba(255,255,255,0.1)', flexWrap: 'wrap', gap: '10px', flexShrink: 0 }}>
            <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
              <span style={{ color: 'white', fontSize: '0.75rem' }}>ì—´:</span>
              {[1, 2, 3].map(col => (
                <button key={col} onClick={() => setColumns(col)} style={{ padding: '6px 12px', border: 'none', borderRadius: '6px', background: columns === col ? 'white' : 'rgba(255,255,255,0.2)', color: columns === col ? 'var(--primary-dark)' : 'white', fontWeight: '600', fontSize: '0.8rem', cursor: 'pointer' }}>{col}</button>
              ))}
            </div>
            <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
              <button onClick={() => setScale(Math.max(0.4, scale - 0.1))} style={{ padding: '6px 14px', border: 'none', borderRadius: '6px', background: 'rgba(255,255,255,0.2)', color: 'white', fontWeight: '700', fontSize: '1rem', cursor: 'pointer' }}>âˆ’</button>
              <span style={{ color: 'white', fontSize: '0.8rem', minWidth: '50px', textAlign: 'center' }}>{Math.round(scale * 100)}%</span>
              <button onClick={() => setScale(Math.min(1.2, scale + 0.1))} style={{ padding: '6px 14px', border: 'none', borderRadius: '6px', background: 'rgba(255,255,255,0.2)', color: 'white', fontWeight: '700', fontSize: '1rem', cursor: 'pointer' }}>+</button>
            </div>
            <button onClick={onClose} style={{ padding: '6px 16px', border: '2px solid white', borderRadius: '8px', background: 'transparent', color: 'white', fontWeight: '600', cursor: 'pointer', fontFamily: 'inherit' }}>âœ• ë‹«ê¸°</button>
          </div>
          
          {/* ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ */}
          <div style={{ flex: 1, overflow: 'auto', padding: '20px', display: 'flex', justifyContent: 'center', alignItems: 'flex-start' }}>
            <div ref={captureRef} style={{ background: 'var(--bg-cream)', padding: '20px', borderRadius: '16px', transform: 'scale(' + scale + ')', transformOrigin: 'top center', width: captureWidth, minWidth: captureWidth }}>
              {/* í—¤ë” */}
              <div style={{ textAlign: 'center', marginBottom: '20px', paddingBottom: '16px', borderBottom: '2px solid var(--primary)' }}>
                <h2 className="title-font" style={{ color: 'var(--primary-dark)', fontSize: '1.5rem' }}>ğŸ’£ CrossFit Superbomb</h2>
                <p style={{ color: 'var(--primary)', fontWeight: '600', fontSize: '1rem' }}>2025 YEAR-END PARTY</p>
                <p style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: '2px', marginBottom: '8px' }}>ğŸ“… 12/6 (SAT) 13:00</p>
                <p style={{ color: 'var(--primary)', fontWeight: '600', fontSize: '1.1rem' }}>{teamDisplayName}</p>
                <p style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: '4px' }}>
                  {coachInfo && ('ğŸ‘‘ ' + coachInfo.name + ' ì½”ì¹˜ Â· ')}
                  ë‚¨ {members.male.length}ëª… / ì—¬ {members.female.length}ëª…{coachInfo?.gender === 'female' ? '+1' : ''}
                  {femaleCount >= 7 ? ' (ì—¬ì„± 7ì¸íŒ€)' : ' (ì—¬ì„± 6ì¸íŒ€)'}
                </p>
              </div>
              
              {/* ì´ë²¤íŠ¸ ê·¸ë¦¬ë“œ */}
              <div style={{ display: 'grid', gridTemplateColumns: gridColumns, gap: '10px' }}>
                {eventsData.map(event => {
                  const eventAssignments = assignments[event.id] || {};
                  const hasAssignments = Object.values(eventAssignments).some(v => v);
                  const isCoachEvent = coachWodEvent === event.id;
                  if (!hasAssignments && !isCoachEvent) return null;
                  
                  return (
                    <div key={event.id} style={{ background: 'white', borderRadius: '10px', overflow: 'hidden', border: isCoachEvent ? '2px solid #E65100' : '1px solid #e0d5c7' }}>
                      <div style={{ background: isCoachEvent ? 'linear-gradient(135deg, #E65100 0%, #FF8C00 100%)' : 'linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%)', padding: '8px 10px', color: 'white' }}>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                          <span style={{ background: 'rgba(255,255,255,0.25)', padding: '2px 8px', borderRadius: '8px', fontSize: '0.65rem', fontWeight: '700' }}>E{event.id}</span>
                          <span style={{ fontWeight: '700', fontSize: '0.8rem' }}>{event.name}</span>
                          {isCoachEvent && <span style={{ marginLeft: 'auto', fontSize: '0.65rem' }}>ğŸ‘‘</span>}
                        </div>
                        <div style={{ fontSize: '0.55rem', opacity: 0.9, marginTop: '4px' }}>{event.description}</div>
                      </div>
                      <div style={{ padding: '8px' }}>
                        {/* ìŠ¬ë¡¯ ìˆœì„œëŒ€ë¡œ í‘œì‹œ (ì½”ì¹˜ í¬í•¨) */}
                        {event.slots.map(slot => {
                          const assigned = eventAssignments[slot.id];
                          if (!assigned) return null;
                          
                          const isCoachSlot = assigned.includes('ì½”ì¹˜');
                          const slotColor = isCoachSlot ? '#E65100' : slot.gender === 'male' ? '#1565C0' : slot.gender === 'female' ? '#C2185B' : '#9C27B0';
                          const slotBg = isCoachSlot ? 'rgba(230, 81, 0, 0.15)' : slot.gender === 'male' ? 'rgba(21, 101, 192, 0.08)' : slot.gender === 'female' ? 'rgba(194, 24, 91, 0.08)' : 'rgba(156, 39, 176, 0.08)';
                          return (
                            <div key={slot.id} style={{ display: 'flex', alignItems: 'center', gap: '6px', padding: '5px 8px', marginBottom: '4px', background: slotBg, borderRadius: '6px', borderLeft: '3px solid ' + slotColor }}>
                              <span style={{ fontWeight: '700', fontSize: '0.7rem', color: slotColor, minWidth: '28px' }}>{slot.label}{isCoachSlot && ' ğŸ‘‘'}</span>
                              <span style={{ fontWeight: '600', fontSize: '0.75rem', color: isCoachSlot ? '#E65100' : 'var(--primary-dark)', minWidth: '45px' }}>{assigned}</span>
                              <span style={{ fontSize: '0.6rem', color: isCoachSlot ? '#E65100' : 'var(--text-muted)', flex: 1, textAlign: 'right' }}>{slot.action}</span>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  );
                })}
              </div>
              
              {/* ë©¤ë²„ë³„ ì°¸ì—¬ í˜„í™© */}
              <div style={{ marginTop: '20px', paddingTop: '16px', borderTop: '2px solid var(--primary)' }}>
                <div style={{ fontSize: '0.8rem', fontWeight: '600', color: 'var(--primary-dark)', marginBottom: '10px' }}>ğŸ“Š ë©¤ë²„ë³„ ì°¸ì—¬ í˜„í™©</div>
                
                {/* ì½”ì¹˜ */}
                {coachInfo && (
                  <div style={{ marginBottom: '10px' }}>
                    <div style={{ fontSize: '0.7rem', color: '#E65100', fontWeight: '600', marginBottom: '6px' }}>ğŸ‘‘ ì½”ì¹˜</div>
                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '4px' }}>
                      {(() => {
                        const coachCount = coachWodEvent ? 1 : 0;
                        const statusColor = coachCount === 1 ? 'var(--success)' : 'var(--warning)';
                        const statusBg = coachCount === 1 ? 'rgba(34, 139, 34, 0.15)' : 'rgba(255, 140, 0, 0.15)';
                        return <span style={{ padding: '3px 6px', borderRadius: '4px', fontSize: '0.7rem', background: statusBg, color: statusColor, border: '1px solid ' + statusColor }}>{coachInfo.name} ì½”ì¹˜ ({coachCount}/1)</span>;
                      })()}
                    </div>
                  </div>
                )}
                
                <div style={{ marginBottom: '10px' }}>
                  <div style={{ fontSize: '0.7rem', color: '#1565C0', fontWeight: '600', marginBottom: '6px' }}>ğŸš¹ ë‚¨ì ({members.male.length}ëª…)</div>
                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: '4px' }}>
                    {members.male.map(name => {
                      const count = getAssignmentCount(name);
                      const statusColor = count === 2 ? 'var(--success)' : count > 2 ? 'var(--accent-red)' : 'var(--warning)';
                      const statusBg = count === 2 ? 'rgba(34, 139, 34, 0.15)' : count > 2 ? 'rgba(196, 30, 58, 0.15)' : 'rgba(255, 140, 0, 0.15)';
                      return <span key={name} style={{ padding: '3px 6px', borderRadius: '4px', fontSize: '0.7rem', background: statusBg, color: statusColor, border: '1px solid ' + statusColor }}>{name} ({count}/2)</span>;
                    })}
                  </div>
                </div>
                <div>
                  <div style={{ fontSize: '0.7rem', color: '#C2185B', fontWeight: '600', marginBottom: '6px' }}>ğŸšº ì—¬ì ({members.female.length}ëª…)</div>
                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: '4px' }}>
                    {members.female.map(name => {
                      const count = getAssignmentCount(name);
                      const statusColor = count === 2 ? 'var(--success)' : count > 2 ? 'var(--accent-red)' : 'var(--warning)';
                      const statusBg = count === 2 ? 'rgba(34, 139, 34, 0.15)' : count > 2 ? 'rgba(196, 30, 58, 0.15)' : 'rgba(255, 140, 0, 0.15)';
                      return <span key={name} style={{ padding: '3px 6px', borderRadius: '4px', fontSize: '0.7rem', background: statusBg, color: statusColor, border: '1px solid ' + statusColor }}>{name} ({count}/2)</span>;
                    })}
                  </div>
                </div>
              </div>
              
              {/* ë©¤ë²„ë³„ ì™€ë“œ ìƒì„¸ */}
              <div style={{ marginTop: '16px', paddingTop: '16px', borderTop: '1px dashed var(--primary-light)' }}>
                <div style={{ fontSize: '0.8rem', fontWeight: '600', color: 'var(--primary-dark)', marginBottom: '10px' }}>ğŸ¯ ë©¤ë²„ë³„ ì™€ë“œ ìƒì„¸</div>
                
                {/* ì½”ì¹˜ - ìµœìƒìœ„ */}
                {coachInfo && coachWodEvent && (
                  <div style={{ marginBottom: '12px' }}>
                    <div style={{ fontSize: '0.7rem', color: '#E65100', fontWeight: '600', marginBottom: '6px' }}>ğŸ‘‘ ì½”ì¹˜</div>
                    <div style={{ display: 'grid', gridTemplateColumns: gridColumns, gap: '4px' }}>
                      {(() => {
                        // ì½”ì¹˜ê°€ ë°°ì •ëœ ìŠ¬ë¡¯ ì°¾ê¸°
                        const coachEvent = eventsData.find(e => e.id === coachWodEvent);
                        const coachSlotId = Object.entries(assignments[coachWodEvent] || {}).find(([id, name]) => name && name.includes('ì½”ì¹˜'))?.[0];
                        const coachSlot = coachSlotId ? coachEvent?.slots.find(s => s.id === coachSlotId) : null;
                        
                        return (
                          <div style={{ background: 'rgba(230, 81, 0, 0.08)', padding: '6px 8px', borderRadius: '6px', borderLeft: '2px solid #E65100' }}>
                            <div style={{ fontWeight: '600', fontSize: '0.7rem', color: '#E65100', marginBottom: '3px' }}>{coachInfo.name} ì½”ì¹˜</div>
                            <div style={{ fontSize: '0.6rem', color: 'var(--text-muted)', lineHeight: '1.3' }}>
                              E{coachWodEvent}: {coachSlot ? coachSlot.action : coachEvent?.name}
                            </div>
                          </div>
                        );
                      })()}
                    </div>
                  </div>
                )}
                
                <div style={{ marginBottom: '12px' }}>
                  <div style={{ fontSize: '0.7rem', color: '#1565C0', fontWeight: '600', marginBottom: '6px' }}>ğŸš¹ ë‚¨ì</div>
                  <div style={{ display: 'grid', gridTemplateColumns: gridColumns, gap: '4px' }}>
                    {members.male.map(name => {
                      const memberWods = [];
                      eventsData.forEach(event => {
                        const ea = assignments[event.id] || {};
                        Object.entries(ea).forEach(([slotId, an]) => {
                          if (an === name) {
                            const slot = event.slots.find(s => s.id === slotId);
                            memberWods.push({ eventId: event.id, action: slot?.action || '' });
                          }
                        });
                      });
                      if (memberWods.length === 0) return null;
                      return (
                        <div key={name} style={{ background: 'rgba(21, 101, 192, 0.05)', padding: '6px 8px', borderRadius: '6px', borderLeft: '2px solid #1565C0' }}>
                          <div style={{ fontWeight: '600', fontSize: '0.7rem', color: '#1565C0', marginBottom: '3px' }}>{name}</div>
                          {memberWods.map((wod, idx) => <div key={idx} style={{ fontSize: '0.6rem', color: 'var(--text-muted)', lineHeight: '1.3' }}>E{wod.eventId}: {wod.action}</div>)}
                        </div>
                      );
                    })}
                  </div>
                </div>
                <div>
                  <div style={{ fontSize: '0.7rem', color: '#C2185B', fontWeight: '600', marginBottom: '6px' }}>ğŸšº ì—¬ì</div>
                  <div style={{ display: 'grid', gridTemplateColumns: gridColumns, gap: '4px' }}>
                    {members.female.map(name => {
                      const memberWods = [];
                      eventsData.forEach(event => {
                        const ea = assignments[event.id] || {};
                        Object.entries(ea).forEach(([slotId, an]) => {
                          if (an === name) {
                            const slot = event.slots.find(s => s.id === slotId);
                            memberWods.push({ eventId: event.id, action: slot?.action || '' });
                          }
                        });
                      });
                      if (memberWods.length === 0) return null;
                      return (
                        <div key={name} style={{ background: 'rgba(194, 24, 91, 0.05)', padding: '6px 8px', borderRadius: '6px', borderLeft: '2px solid #C2185B' }}>
                          <div style={{ fontWeight: '600', fontSize: '0.7rem', color: '#C2185B', marginBottom: '3px' }}>{name}</div>
                          {memberWods.map((wod, idx) => <div key={idx} style={{ fontSize: '0.6rem', color: 'var(--text-muted)', lineHeight: '1.3' }}>E{wod.eventId}: {wod.action}</div>)}
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          {/* í•˜ë‹¨ ê³µìœ  ë²„íŠ¼ */}
          <div style={{ padding: '12px 16px', background: 'rgba(255,255,255,0.1)', display: 'flex', justifyContent: 'center', flexShrink: 0 }}>
            <button onClick={handleShareOrDownload} disabled={processing} style={{ padding: '14px 40px', border: 'none', borderRadius: '12px', background: 'linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)', color: 'white', fontWeight: '700', fontSize: '1rem', cursor: processing ? 'wait' : 'pointer', fontFamily: 'inherit', boxShadow: '0 4px 15px rgba(139, 69, 19, 0.4)' }}>
              {processing ? 'ì²˜ë¦¬ ì¤‘...' : 'ğŸ“¤ ê³µìœ í•˜ê¸°'}
            </button>
          </div>
        </div>
      );
    };
    
    const App = () => {
      const [selectedTeam, setSelectedTeam] = useState('D');
      const [assignments, setAssignments] = useState({});
      const [teamCoaches, setTeamCoaches] = useState({});
      const [coachWod, setCoachWod] = useState({});
      const [memberListExpanded, setMemberListExpanded] = useState(false);
      const [animatingSlot, setAnimatingSlot] = useState(null);
      const [showCapture, setShowCapture] = useState(false);
      const [showRulebookCapture, setShowRulebookCapture] = useState(false);
      const [snowEnabled, setSnowEnabled] = useState(false);
      
      const members = TEAMS_DATA[selectedTeam];
      
      // í˜„ì¬ íŒ€ì˜ ì½”ì¹˜ ì •ë³´
      const selectedCoach = teamCoaches[selectedTeam];
      const coachInfo = selectedCoach ? COACHES.find(c => c.id === selectedCoach) : null;
      
      // íŒ€ í‘œì‹œëª…
      const teamDisplayName = coachInfo ? `TEAM-${selectedCoach}` : `TEAM-${selectedTeam}`;
      
      // ì—¬ì„± ì¸ì›ìˆ˜ ê³„ì‚° (ì˜ˆì§€ ì½”ì¹˜ê°€ ë°°ì •ëœ ê²½ìš° +1)
      const femaleCount = members.female.length + (coachInfo?.gender === 'female' ? 1 : 0);
      const eventsData = getEventsData(femaleCount);
      
      // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
      useEffect(() => {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
          try {
            const parsed = JSON.parse(saved);
            setAssignments(parsed);
          } catch (e) {
            console.error('ì €ì¥ëœ ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);
          }
        }
        
        const savedCoaches = localStorage.getItem(COACH_STORAGE_KEY);
        if (savedCoaches) {
          try {
            const parsed = JSON.parse(savedCoaches);
            setTeamCoaches(parsed.coaches || {});
            setCoachWod(parsed.wod || {});
          } catch (e) {
            console.error('ì½”ì¹˜ ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);
          }
        }
      }, []);
      
      // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
      useEffect(() => {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(assignments));
      }, [assignments]);
      
      useEffect(() => {
        localStorage.setItem(COACH_STORAGE_KEY, JSON.stringify({
          coaches: teamCoaches,
          wod: coachWod
        }));
      }, [teamCoaches, coachWod]);
      
      const currentTeamAssignments = assignments[selectedTeam] || {};
      
      const handleAssign = (eventId, slotId, memberName) => {
        setAnimatingSlot(`${eventId}-${slotId}`);
        setTimeout(() => setAnimatingSlot(null), 300);
        
        setAssignments(prev => ({
          ...prev,
          [selectedTeam]: {
            ...(prev[selectedTeam] || {}),
            [eventId]: {
              ...((prev[selectedTeam] || {})[eventId] || {}),
              [slotId]: memberName
            }
          }
        }));
      };
      
      const handleCoachChange = (teamKey, coachId) => {
        setTeamCoaches(prev => ({
          ...prev,
          [teamKey]: coachId
        }));
        // ì½”ì¹˜ ë³€ê²½ ì‹œ ì™€ë“œë„ ì´ˆê¸°í™”
        if (!coachId) {
          setCoachWod(prev => ({
            ...prev,
            [teamKey]: null
          }));
        }
      };
      
      const handleCoachWodChange = (teamKey, eventId) => {
        const prevEventId = coachWod[teamKey];
        const coachId = teamCoaches[teamKey];
        const coachInfo = coachId ? COACHES.find(c => c.id === coachId) : null;
        
        // ì´ì „ ì™€ë“œì—ì„œ ì½”ì¹˜ ë°°ì • ì œê±°
        if (prevEventId && coachInfo) {
          setAssignments(prev => {
            const teamAssignments = prev[teamKey] || {};
            const prevEventAssignments = teamAssignments[prevEventId] || {};
            
            // ì½”ì¹˜ê°€ ë°°ì •ëœ ìŠ¬ë¡¯ ì°¾ì•„ì„œ ì œê±°
            const newPrevEventAssignments = {};
            Object.entries(prevEventAssignments).forEach(([slotId, name]) => {
              if (name && !name.includes('ì½”ì¹˜')) {
                newPrevEventAssignments[slotId] = name;
              }
            });
            
            return {
              ...prev,
              [teamKey]: {
                ...teamAssignments,
                [prevEventId]: newPrevEventAssignments
              }
            };
          });
        }
        
        setCoachWod(prev => ({
          ...prev,
          [teamKey]: eventId
        }));
      };
      
      const handleReset = () => {
        if (confirm(`${TEAMS_DATA[selectedTeam].name}ì˜ ëª¨ë“  ë°°ì •ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ì½”ì¹˜ í¬í•¨)`)) {
          setAssignments(prev => ({
            ...prev,
            [selectedTeam]: {}
          }));
          setTeamCoaches(prev => ({
            ...prev,
            [selectedTeam]: null
          }));
          setCoachWod(prev => ({
            ...prev,
            [selectedTeam]: null
          }));
        }
      };
      
      const handleResetEvent = (eventId) => {
        if (confirm(`EVENT ${eventId}ì˜ ë°°ì •ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
          setAssignments(prev => ({
            ...prev,
            [selectedTeam]: {
              ...(prev[selectedTeam] || {}),
              [eventId]: {}
            }
          }));
        }
      };
      
      const handleTeamChange = (teamKey) => {
        setSelectedTeam(teamKey);
      };
      
      return (
        <div style={{ paddingBottom: '80px' }}>
          <Header 
            selectedTeam={selectedTeam} 
            onTeamChange={handleTeamChange}
            teamCoaches={teamCoaches}
            onCoachChange={handleCoachChange}
          />
          
          {/* ì½”ì¹˜ ë°°ì • ì„¹ì…˜ */}
          <CoachSection
            teamKey={selectedTeam}
            teamCoaches={teamCoaches}
            onCoachChange={handleCoachChange}
            coachWod={coachWod}
            onCoachWodChange={handleCoachWodChange}
            eventsData={eventsData}
            assignments={currentTeamAssignments}
          />
          
          {/* íŒ€ êµ¬ì„± ì•ˆë‚´ */}
          <div style={{
            margin: '16px 16px 0',
            padding: '10px 14px',
            background: femaleCount >= 7 
              ? 'rgba(194, 24, 91, 0.1)' 
              : 'rgba(21, 101, 192, 0.1)',
            borderRadius: '10px',
            border: `1px solid ${femaleCount >= 7 ? 'rgba(194, 24, 91, 0.3)' : 'rgba(21, 101, 192, 0.3)'}`,
            fontSize: '0.85rem',
            display: 'flex',
            alignItems: 'center',
            gap: '8px'
          }}>
            <span style={{ fontSize: '1.1rem' }}>
              {femaleCount >= 7 ? 'ğŸ‘©' : 'ğŸ‘¨'}
            </span>
            <span>
              <strong>ë‚¨ {members.male.length}ëª… / ì—¬ {members.female.length}ëª…</strong>
              {coachInfo && <span> + {coachInfo.name} ì½”ì¹˜({coachInfo.gender === 'female' ? 'ì—¬' : 'ë‚¨'})</span>}
              {' â†’ '}
              <span style={{ 
                color: femaleCount >= 7 ? '#C2185B' : '#1565C0',
                fontWeight: '600'
              }}>
                {femaleCount >= 7 ? 'ì—¬ì„± 7ì¸íŒ€ ê·œì¹™ ì ìš©' : 'ì—¬ì„± 6ì¸íŒ€ ê·œì¹™ ì ìš©'}
              </span>
            </span>
          </div>
          
          <MemberStatus 
            members={members}
            assignments={currentTeamAssignments}
            teamKey={selectedTeam}
            eventsData={eventsData}
            teamCoaches={teamCoaches}
            coachWod={coachWod}
          />
          
          <MemberList 
            members={members}
            assignments={currentTeamAssignments}
            expanded={memberListExpanded}
            onToggle={() => setMemberListExpanded(!memberListExpanded)}
            eventsData={eventsData}
            teamCoaches={teamCoaches}
            teamKey={selectedTeam}
            coachWod={coachWod}
          />
          
          <div style={{ 
            padding: '0 16px 8px',
            fontSize: '0.85rem',
            color: 'var(--primary-dark)',
            fontWeight: '600'
          }}>
            ğŸ¯ ì´ë²¤íŠ¸ë³„ ë°°ì •
          </div>
          
          {eventsData.map(event => (
            <EventCard
              key={event.id}
              event={event}
              members={members}
              assignments={currentTeamAssignments}
              onAssign={handleAssign}
              onResetEvent={handleResetEvent}
              animatingSlot={animatingSlot}
              coachWodEvent={coachWod[selectedTeam]}
              coachInfo={coachInfo}
              teamDisplayName={teamDisplayName}
              femaleCount={femaleCount}
            />
          ))}
          
          <ActionButtons 
            onReset={handleReset}
            onCapture={() => setShowCapture(true)}
            onRulebookCapture={() => setShowRulebookCapture(true)}
            onSnowToggle={() => setSnowEnabled(!snowEnabled)}
            snowEnabled={snowEnabled}
            assignments={currentTeamAssignments}
          />

          <Footer />
          
          <SnowEffect enabled={snowEnabled} />
          
          {showCapture && (
            <CaptureView
              teamKey={selectedTeam}
              members={members}
              assignments={currentTeamAssignments}
              onClose={() => setShowCapture(false)}
              eventsData={eventsData}
              teamCoaches={teamCoaches}
              coachWod={coachWod}
            />
          )}
          
          {showRulebookCapture && (
            <RulebookCaptureView
              onClose={() => setShowRulebookCapture(false)}
              eventsData={eventsData}
            />
          )}
        </div>
      );
    };
    
    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
